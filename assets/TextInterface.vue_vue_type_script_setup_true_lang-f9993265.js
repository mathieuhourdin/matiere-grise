import{e as F,g as T,r as s,h as $,m,l as z,o as a,c as r,n as I,k as P,F as x,p as y,q as W,b as D,t as L}from"./index-56c128f2.js";const N=["onClick"],R={key:0,style:{width:"5px"}},S={key:1,style:{height:"25px"}},V={key:2},K=F({__name:"TextInterface",props:{fullText:{}},emits:["change"],setup(k,{emit:C}){const v=k,h=e=>{if(console.log("textArrayFromString textString: ",e),o.value=[],e===void 0||e==""){o.value=[{id:0,char:`
`}],u(null);return}for(var l=0;l<e.length;l++)o.value.push({id:l,char:e[l]})},_=T(()=>{console.log("Compute lines");let e=[{id:0,text:[]}].concat(o.value.filter(l=>l.char==`
`));console.log("Compute ids.length : ",e.length);for(let l=0;l<e.length-1;l++)console.log("Compute line : ",l),e[l].text=o.value.filter(t=>t.id>=e[l].id&&t.id<e[l+1].id);return e[e.length-1].text=o.value.filter(l=>l.id>=e[e.length-1].id),e}),o=s([]),u=e=>{console.log("selectCursorPosition letter : ",e),n.value={id:e.id,char:e.char}},n=s(null),f=e=>{o.value.filter(l=>l.id>=n.value.id+1).forEach(l=>l.id+=1),o.value.splice(n.value.id+1,0,{id:n.value.id+1,char:e,line:0}),n.value.id+=1},b=e=>{if(console.log("Writes : ",e.key),n.value===null)return;const l=e.key;if(l.length==1)f(l);else if(l=="Backspace")o.value.splice(n.value.id,1),o.value.filter(t=>t.id>n.value.id).forEach(t=>t.id-=1),n.value.id-=1;else if(l=="Enter")f(`
`);else if(l=="ArrowRight"){let t=n.value.id;t<o.value.length-1&&u(o.value[t+1])}else if(l=="ArrowLeft"){let t=n.value.id;t>0&&u(o.value[t-1])}},w=e=>e.reduce((l,t)=>l+t.char,""),c=s(!1),d=s({position:"absolute","z-index":90,top:0,left:0,height:"100px",width:"150px"}),A=e=>{e.preventDefault(),d.value.top=`${e.layerY}px`,d.value.left=`${e.layerX}px`,c.value=!0,console.log("event : ",e),console.log("Have a new right click")},p=s(!1);return $(()=>{h(v.fullText),p.value=!0}),m(o,e=>{console.log("Watch triggered : ",e),p.value&&C("change",w(e))},{deep:!0}),m(z(v).fullText,e=>{h(e)}),(e,l)=>(a(),r("div",{class:"border-2 mx-auto relative p-4",tabindex:"0",onKeydown:b,onClick:l[0]||(l[0]=t=>c.value=!1)},[c.value?(a(),r("div",{key:0,class:"bg-white border-4",style:I(d.value)},null,4)):P("",!0),(a(!0),r(x,null,y(_.value,(t,B)=>(a(),r("div",{key:B,class:"flex flex-wrap w-full"},[(a(!0),r(x,null,y(t.text,(i,E)=>{var g;return a(),r("div",{key:E,class:W(["border-blue-400",{"border-r-2":i.id==((g=n.value)==null?void 0:g.id)}]),onClick:q=>u(i),onContextmenu:A},[i.char==" "?(a(),r("div",R)):i.char==`
`?(a(),r("div",S)):(a(),r("div",V,[D("div",null,L(i.char),1)]))],42,N)}),128))]))),128))],32))}});export{K as _};
