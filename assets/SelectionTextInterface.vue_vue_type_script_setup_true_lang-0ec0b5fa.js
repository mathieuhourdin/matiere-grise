import{o as d,f as p,a as h,d as $,b as g,i as E,D as R,n as V,A as B,h as F,e as M,j as S,C as T,F as P,g as z,t as I}from"./index-31dd3446.js";import{u as K}from"./SelectionTextInterface.vue_vue_type_style_index_0_lang-8a1c7c87.js";function J(e,t){return d(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})])}const W=$({__name:"ClipboardButton",props:{text:{}},setup(e){const t=e,i=g(!1),{launchSnackbar:l}=B(),a=async()=>{try{await navigator.clipboard.writeText(t.text),i.value=!0,l("Text copied to clipboard","success"),setTimeout(()=>i.value=!1,2e3)}catch(v){console.log(`Error with copy : ${v}`)}};return(v,C)=>(d(),p("div",null,[E(V(J),{onClick:a,class:R({"text-slate-400":i.value})},null,8,["class"])]))}});let y;const q=new Uint8Array(16);function G(){if(!y&&(y=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(q)}const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function Q(e,t=0){return s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]}const X=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),U={randomUUID:X};function Y(e,t,i){if(U.randomUUID&&!t&&!e)return U.randomUUID();e=e||{};const l=e.random||(e.rng||G)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,t){i=i||0;for(let a=0;a<16;++a)t[i+a]=l[a];return t}return Q(l)}const Z={class:""},ee=h("div",{class:"cursor bg-blue-400"},null,-1),te=[ee],ne=["onClick","id"],oe={key:0},se={key:1,class:"ml-4"},le=$({__name:"SelectionTextInterface",props:{text:{},editable:{type:Boolean}},emits:["change"],setup(e,{emit:t}){const i=e,{launchSnackbar:l}=B(),{textLines:a,keydown:v,editCount:C}=K(),x=g(""),H=F(()=>f()),O=()=>{console.log("Trigger launchHiddenInput");var n=document.getElementById("hidden-input");n.style.opacity="1",n.focus(),setTimeout(()=>{n.style.opacity="0"},50)},D=n=>{console.log(n);const o=window.getSelection();console.log("selection : ",o);const c=o.getRangeAt(0);console.log("range : ",c)},L=n=>{if(!i.editable)return;const c=window.getSelection().getRangeAt(0);u.value={line:n,startOffset:c.startOffset,endOffset:c.endOffset},O()},k=()=>{if(u.value.line===void 0)return;console.log(`CursorPosition : ${JSON.stringify(u.value)}`);const n=document.createRange(),o=document.getElementById(`line-${x.value}-${u.value.line}`);console.log("Selected LIne : ",o);const c=window.getComputedStyle(o).lineHeight,r=o.firstChild.firstChild;n.setStart(r,0),n.setEnd(r,u.value.startOffset);const m=n.getClientRects(),b=m[m.length-1];w.value={left:`${b.right}px`,bottom:`${b.bottom}px`,top:`${b.top-3}px`,height:c}},A=n=>{v(n,u)},w=g({left:"0px",right:"0px"}),u=g({line:void 0,startOffset:void 0,endOffset:void 0}),j=n=>n.split(`
`).map((o,c)=>{let r=!1,m=!1;return o[0]==="#"&&(o=o.slice(1),r=!0),o[0]==="*"&&(o=o.slice(1),m=!0),{index:c,text:o,bold:r,chip:m}}),f=()=>a.value.map(n=>(n.bold?"#":"")+(n.chip?"*":"")+n.text).join(`
`);M(()=>{x.value=Y(),a.value=j(i.text),document.getElementById("router-view").addEventListener("scroll",()=>{k()})});const _=g(null),N=()=>{_.value!==null&&clearTimeout(_.value),_.value=setTimeout(async()=>{const n=f();n===""||!n?l("Try to update with empty content","error"):t("change",f())},1e3)};return S(C,()=>{N()}),S(u,()=>{k()},{deep:!0}),(n,o)=>(d(),p("div",Z,[h("div",{style:T(w.value),class:"absolute flex flex-column"},te,4),h("input",{id:"hidden-input",class:"absolute",style:T({top:w.value.top,left:"99999999px"})},null,4),E(W,{class:"ml-auto h-6 w-6",text:H.value},null,8,["text"]),h("div",{id:"editor-interface",tabindex:"0",onKeydown:o[0]||(o[0]=c=>A(c))},[(d(!0),p(P,null,z(V(a),(c,r)=>(d(),p("div",{class:R(["whitespace-pre-wrap",{"font-bold":c.bold}]),onClick:m=>L(r),onMouseup:D,id:`line-${x.value}-${r}`},[c.chip?(d(),p("li",se,I(c.text),1)):(d(),p("div",oe,I(c.text===""?" ":c.text),1))],42,ne))),256))],32)]))}});export{W as _,le as a};
