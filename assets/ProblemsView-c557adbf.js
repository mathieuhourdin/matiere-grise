import{u as A,a as g}from"./useProblem-6c76ded6.js";import{d as f,r as b,g as y,s as F,o as a,c,k as w,w as $,i as o,t as p,a as C,e as B,f as I,F as x,j as k,q as L,v as N,p as V}from"./index-6c4140f3.js";import{u as D}from"./useResource-b1b16e86.js";const U={class:"border shadow-xl rounded m-2 p-4 h-72 w-60"},j={class:"max-h-full"},q=["src"],S={class:"h-full"},T={class:"mb-2"},E={key:0,class:"text-2xs italic",style:{"margin-top":"-8px"}},M={class:"text-2xs mb-auto"},W={class:"flex mt-2"},z={class:"text-2xs italic mt-auto"},G={class:"ml-auto text-2xs underline"},H=f({__name:"ProblemCard",props:{problem:{}},setup(h){const m=h,n=r=>r?r.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",d=b(null),u=b(null),_=r=>r.length>200?r.slice(0,150)+"...":r,{getAuthorInteractionForResource:i}=D(),t=b([]),{getResourceRelationsForResource:s}=A(),l=async()=>{m.problem.id&&(t.value=await s(m.problem.id))},{getUserById:v}=B(),P=async()=>{d.value=await i(m.problem.id),d.value&&(u.value=await v(d.value.interaction_user_id))};return y(async()=>{await l(),await P()}),(r,Y)=>{const R=F("router-link");return a(),c("div",U,[w(R,{to:"/thought_outputs/"+r.problem.id},{default:$(()=>[o("div",j,[o("img",{class:"h-28 mx-auto mb-4",src:r.problem.image_url},null,8,q),o("div",S,[o("div",T,p(r.problem.title),1),u.value?(a(),c("div",E,p(u.value.first_name)+" "+p(u.value.last_name),1)):C("",!0),o("div",M,p(_(r.problem.subtitle)),1),o("div",W,[o("div",z,p(n(r.problem.created_at)),1),o("div",G,p(t.value.length)+" inputs",1)])])])]),_:1},8,["to"])])}}}),J={class:"flex"},K=o("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),O={class:"flex overflow-scroll"},Q=f({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(h){const m=h;e;const{newProblem:n,createProblem:d}=g(),u=I(),_=async()=>{const t=n();t.resource.category_id=m.category.id;const s=await d(t);u.push({path:"/thought_outputs/"+s.resource.id,query:{editing:"true"}})},i=t=>t=="default"?"Autres":t;return(t,s)=>(a(),c("div",null,[o("div",J,[o("div",null,p(i(t.category.display_name)),1),o("div",{onClick:_,class:"ml-auto text-sm mr-2 underline"},"Ajouter")]),K,o("div",O,[(a(!0),c(x,null,k(t.problemsList,(l,v)=>(a(),c("div",{class:"mb-4",key:v},[w(H,{problem:l},null,8,["problem"])]))),128))])]))}}),X={key:0,class:"m-4"},se=f({__name:"ProblemsView",setup(h){const{getProblems:m}=g(),n=b(null),{categories:d}=N(),u=L(()=>d.value.map(t=>(t.problems=_(t),t.problems_count=t.problems?t.problems.length:0,t))),_=i=>{var t,s;return i.display_name=="default"?(t=n.value)==null?void 0:t.filter(l=>l.category_id==null):(s=n.value)==null?void 0:s.filter(l=>l.category_id==i.id)};return y(async()=>n.value=await m()),(i,t)=>(a(),c("div",null,[n.value?(a(),c("div",X,[(a(!0),c(x,null,k(u.value.sort((s,l)=>l.problems_count-s.problems_count),s=>(a(),V(Q,{class:"mt-4",category:s,key:s.id,"problems-list":s.problems},null,8,["category","problems-list"]))),128))])):C("",!0)]))}});export{se as default};
