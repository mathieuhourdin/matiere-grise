import{l as x,d as h,r as b,k as g,m as k,o as l,c as m,i as f,w as T,g as r,t as d,a as v,e as $,n as B,F as y,p as w,q as F,s as I,j as U}from"./index-7f0fbf45.js";import{u as A,a as D}from"./useThoughtOutput-03f2ac94.js";const{createThoughtOutput:L}=A(),N=()=>({resource_title:"",resource_subtitle:"",resource_content:"",resource_publishing_state:"drft",resource_image_url:"",resource_type:"pblm",interaction_progress:0,resource_comment:"",resource_maturing_state:""}),V=o=>(o.created_at&&(o.created_at=new Date(o.created_at.split(".")[0])),o),O=async()=>(await x.get("/problems")).data.map(a=>V(a));function P(){return{newProblem:N,getProblems:O,createProblem:L}}const R={class:"border shadow-xl rounded m-2 p-4 h-72 w-60"},j={class:"max-h-full"},q=["src"],S={class:"h-full"},W={class:"mb-2"},E={key:0,class:"text-2xs italic",style:{"margin-top":"-8px"}},M={class:"text-2xs mb-auto"},z={class:"flex mt-2"},G={class:"text-2xs italic mt-auto"},H={class:"ml-auto text-2xs underline"},J=h({__name:"ProblemCard",props:{problem:{}},setup(o){const a=o,u=t=>t?t.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",c=b(null),p=t=>t.length>200?t.slice(0,150)+"...":t,_=b([]),{getThoughtInputUsagesForThoughtOutput:i}=D(),e=async()=>{a.problem.id&&(_.value=await i(a.problem.id))},{getUserById:s}=$(),n=async()=>{a.problem.interaction_user_id&&(c.value=await s(a.problem.interaction_user_id))};return g(async()=>{await e(),await n()}),(t,ee)=>{const C=k("router-link");return l(),m("div",R,[f(C,{to:"/thought_outputs/"+t.problem.id},{default:T(()=>[r("div",j,[r("img",{class:"h-28 mx-auto mb-4",src:t.problem.resource_image_url},null,8,q),r("div",S,[r("div",W,d(t.problem.resource_title),1),c.value?(l(),m("div",E,d(c.value.first_name)+" "+d(c.value.last_name),1)):v("",!0),r("div",M,d(p(t.problem.resource_subtitle)),1),r("div",z,[r("div",G,d(u(t.problem.created_at)),1),r("div",H,d(_.value.length)+" inputs",1)])])])]),_:1},8,["to"])])}}}),K={class:"flex"},Q=r("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),X={class:"flex overflow-scroll"},Y=h({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(o){const a=o,{newProblem:u,createProblem:c}=P(),p=B(),_=async()=>{const e=u();e.resource_category_id=a.category.id;const s=await c(e);p.push({path:"/thought_outputs/"+s.id,query:{editing:"true"}})},i=e=>e=="default"?"Autres":e;return(e,s)=>(l(),m("div",null,[r("div",K,[r("div",null,d(i(e.category.display_name)),1),r("div",{onClick:_,class:"ml-auto text-sm mr-2 underline"},"Ajouter")]),Q,r("div",X,[(l(!0),m(y,null,w(e.problemsList,(n,t)=>(l(),m("div",{class:"mb-4",key:t},[f(J,{problem:n},null,8,["problem"])]))),128))])]))}}),Z={key:0,class:"m-4"},re=h({__name:"ProblemsView",setup(o){const{getProblems:a}=P(),u=b(null),{categories:c}=I(),p=F(()=>c.value.map(e=>(e.problems=_(e),e.problems_count=e.problems?e.problems.length:0,e))),_=i=>{var e,s;return i.display_name=="default"?(e=u.value)==null?void 0:e.filter(n=>n.resource_category_id==null):(s=u.value)==null?void 0:s.filter(n=>n.resource_category_id==i.id)};return g(async()=>u.value=await a()),(i,e)=>(l(),m("div",null,[u.value?(l(),m("div",Z,[(l(!0),m(y,null,w(p.value.sort((s,n)=>n.problems_count-s.problems_count),s=>(l(),U(Y,{class:"mt-4",category:s,key:s.id,"problems-list":s.problems},null,8,["category","problems-list"]))),128))])):v("",!0)]))}});export{re as default};
