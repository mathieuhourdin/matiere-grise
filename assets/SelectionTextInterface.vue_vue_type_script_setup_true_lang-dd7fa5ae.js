import{o as d,f as p,a as h,d as E,b as m,i as R,D as V,n as B,A as H,h as F,e as K,j as T,C as I,F as M,g as P,t as U}from"./index-9488f31e.js";import{u as z}from"./SelectionTextInterface.vue_vue_type_style_index_0_lang-3d9cb80c.js";function J(e,t){return d(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[h("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})])}const W=E({__name:"ClipboardButton",props:{text:{}},setup(e){const t=e,c=m(!1),{launchSnackbar:l}=H(),r=async()=>{try{await navigator.clipboard.writeText(t.text),c.value=!0,l("Text copied to clipboard","success"),setTimeout(()=>c.value=!1,2e3)}catch(v){console.log(`Error with copy : ${v}`)}};return(v,C)=>(d(),p("div",null,[R(B(J),{onClick:r,class:V({"text-slate-400":c.value})},null,8,["class"])]))}});let x;const q=new Uint8Array(16);function G(){if(!x&&(x=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!x))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(q)}const i=[];for(let e=0;e<256;++e)i.push((e+256).toString(16).slice(1));function Q(e,t=0){return i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]}const X=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),$={randomUUID:X};function Y(e,t,c){if($.randomUUID&&!t&&!e)return $.randomUUID();e=e||{};const l=e.random||(e.rng||G)();if(l[6]=l[6]&15|64,l[8]=l[8]&63|128,t){c=c||0;for(let r=0;r<16;++r)t[c+r]=l[r];return t}return Q(l)}const Z={class:""},ee=h("div",{class:"cursor bg-blue-400"},null,-1),te=[ee],ne=["onClick","id"],oe={key:0},se={key:1,class:"ml-4"},le=E({__name:"SelectionTextInterface",props:{text:{},editable:{type:Boolean}},emits:["change"],setup(e,{emit:t}){const c=e,{launchSnackbar:l}=H(),{textLines:r,keydown:v,editCount:C}=z(),w=m(""),O=F(()=>f()),D=()=>{console.log("Trigger launchHiddenInput");var n=document.getElementById("hidden-input");n.style.opacity="1",n.focus(),setTimeout(()=>{n.style.opacity="0"},50)},L=n=>{console.log(n);const o=window.getSelection();console.log("selection : ",o);const s=o.getRangeAt(0);console.log("range : ",s)},A=n=>{if(!c.editable)return;const s=window.getSelection().getRangeAt(0);u.value={line:n,startOffset:s.startOffset,endOffset:s.endOffset},D()},k=()=>{if(u.value.line===void 0)return;console.log(`CursorPosition : ${JSON.stringify(u.value)}`);const n=document.createRange(),o=document.getElementById(`line-${w.value}-${u.value.line}`);console.log("Selected LIne : ",o);const s=window.getComputedStyle(o).lineHeight,a=o.firstChild.firstChild;n.setStart(a,0),n.setEnd(a,u.value.startOffset);const g=n.getClientRects(),_=g[g.length-1];y.value={left:`${_.right}px`,bottom:`${_.bottom}px`,top:`${_.top-3}px`,height:s}},S=n=>{v(n,u)},y=m({left:"0px",right:"0px"}),u=m({line:void 0,startOffset:void 0,endOffset:void 0}),j=n=>n.split(`
`).map((o,s)=>{let a=!1,g=!1;return o[0]==="#"&&(o=o.slice(1),a=!0),o[0]==="*"&&(o=o.slice(1),g=!0),{index:s,text:o,bold:a,chip:g}}),f=()=>r.value.map(n=>(n.bold?"#":"")+(n.chip?"*":"")+n.text).join(`
`);K(()=>{w.value=Y(),r.value=j(c.text),document.getElementById("router-view").addEventListener("scroll",()=>{k()})});const b=m(null),N=()=>{b.value!==null&&clearTimeout(b.value),b.value=setTimeout(async()=>{const n=f();n===""||!n?l("Try to update with empty content","error"):t("change",f())},1e3)};return T(C,()=>{N()}),T(u,()=>{k()},{deep:!0}),(n,o)=>(d(),p("div",Z,[h("div",{style:I(y.value),class:"absolute flex flex-column"},te,4),h("input",{id:"hidden-input",class:"absolute",style:I([{height:"0",width:"0",border:"0",padding:"0"},{top:y.value.top,left:y.value.left}]),onKeydown:o[0]||(o[0]=s=>S(s))},null,36),R(W,{class:"ml-auto h-6 w-6",text:O.value},null,8,["text"]),h("div",{id:"editor-interface",tabindex:"0",onKeydown:o[1]||(o[1]=s=>S(s))},[(d(!0),p(M,null,P(B(r),(s,a)=>(d(),p("div",{class:V(["whitespace-pre-wrap",{"font-bold":s.bold}]),onClick:g=>A(a),onMouseup:L,id:`line-${w.value}-${a}`},[s.chip?(d(),p("li",se,U(s.text),1)):(d(),p("div",oe,U(s.text===""?" ":s.text),1))],42,ne))),256))],32)]))}});export{le as _,W as a};
