import{o as s,c as p,f as r,d as T,r as c,l as C,t as I,u as N,i as f,h as i,_ as x,e as z,m as D,n as R,F as K,p as Q,q as P,s as W,w as U,v as X,a as L,x as Y,y as Z,z as M}from"./index-de4e0cfe.js";import{a as S,b as ee,_ as te}from"./ArticleForm.vue_vue_type_script_setup_true_lang-75bd85b7.js";import{_ as E,u as oe,a as se}from"./ModalSheet.vue_vue_type_script_setup_true_lang-83d0c854.js";import{u as H,a as le}from"./useThoughtOutput-514797d1.js";import{_ as ue,u as ae}from"./TextInterface.vue_vue_type_script_setup_true_lang-8432e5db.js";import{_ as O}from"./TextInput.vue_vue_type_script_setup_true_lang-f0e1b8ea.js";function ne(_,d){return s(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}const re={key:1},ie={class:"flex flex-row-reverse"},de=T({__name:"CreateThoughtInputUsageForm",props:{thoughtOutput:{}},emits:["close","refresh"],setup(_,{emit:d}){const h=_,{user:m}=z(),a=c([]),l=c(null),t=c(""),{createThoughtInputUsage:g}=H(),v=async()=>{console.log("create");const b={thought_output_id:h.thoughtOutput.id,thought_input_id:l.value.id,usage_reason:t.value};await g(b),d("refresh"),d("close")},{getUserThoughtInputs:k}=oe(),$=b=>{l.value=b};return C(async()=>a.value=await k(m.value.id)),(b,e)=>(s(),p("div",null,[r("div",null,I(N(m).first_name),1),l.value?(s(),p("div",re,[i(S,{label:"Pourquoi ajouter cet élément ?",modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=y=>t.value=y)},null,8,["modelValue"]),r("div",ie,[i(x,{type:"valid",onClick:v,text:"Ajouter"}),i(x,{type:"abort",onClick:e[2]||(e[2]=y=>d("close")),text:"Ajouter"})])])):(s(),f(E,{key:0,"thought-inputs":a.value,center:"",onSelect:e[0]||(e[0]=y=>$(y))},null,8,["thought-inputs"]))]))}}),ce={class:"mx-auto flex flex-wrap max-w-full"},pe=T({__name:"ToggleButtonGroup",props:{choices:{},default:{}},setup(_){const d=_,h=c(null),m=D(),a=R(),l=t=>{h.value=t;const g=a.query,v=a.path;m.push({path:v,query:{...g,tab:t}}),console.log(`route : ${JSON.stringify(a)}`)};return C(()=>l(d.default)),(t,g)=>(s(),p("div",ce,[(s(!0),p(K,null,Q(t.choices,v=>(s(),f(x,{key:v.value,class:"w-24 mx-auto my-1 md:mx-1",text:v.text,onClick:k=>l(v.value),type:v.value==h.value?"valid":"abort"},null,8,["text","onClick","type"]))),128))]))}}),me={class:"flex"},ve={class:"flex"},he=T({__name:"ProblemForm",props:{problem:{}},emits:["change"],setup(_,{emit:d}){const h=_,m=(a,l)=>{let t={...h.problem};t[a]=l,d("change",t)};return(a,l)=>(s(),p("div",null,[i(O,{label:"Titre",modelValue:a.problem.title,"onUpdate:modelValue":l[0]||(l[0]=t=>m("title",t))},null,8,["modelValue"]),i(O,{class:"h-6",label:"Description",modelValue:a.problem.description,"onUpdate:modelValue":l[1]||(l[1]=t=>m("description",t))},null,8,["modelValue"]),r("div",me,[i(ee,{class:"mr-auto h-6",label:"Progression",modelValue:a.problem.progress,"onUpdate:modelValue":l[2]||(l[2]=t=>m("progress",t))},null,8,["modelValue"])]),r("div",ve,[i(O,{class:"h-6",label:"Lien image",modelValue:a.problem.image_url,"onUpdate:modelValue":l[3]||(l[3]=t=>m("image_url",t))},null,8,["modelValue"])])]))}}),ge={key:0,class:"px-8 mx-auto"},_e={key:0},fe={class:"my-8"},be=["src"],ye={class:"text-3xl my-3 font-mplus md:text-center text-left"},xe={class:"md:text-center text-left"},ke={class:"md:flex my-8"},$e=["href"],Ce={key:1},Te={class:"flex flex-row-reverse"},we={key:1,class:"p-2 border rounded bg-neutral-100"},Ve=r("hr",{class:"border-top border-zinc-400 my-4"},null,-1),Ue={key:2},Oe={key:3},Pe=T({__name:"SeeArticle",props:{id:{}},setup(_){const d=_,h=R(),m=c([{text:"Contenu",value:"ctnt"},{text:"Biblio",value:"bbli"}]),a=c(null);P(()=>h.query.tab,u=>{console.log("new route query",u),a.value=u});const{getThoughtInputUsagesForThoughtOutput:l}=H(),t=c([]),g=c(!1),v=async()=>{t.value=await l(M(d).id.value)};C(()=>v());const{getThoughtOutput:k,updateThoughtOutput:$}=le(),b=c(null),e=c(null),y=D();P(()=>h.query.editing,u=>{console.log("Editing : ",u),w.value=u==="false"?!1:!!u});const w=c(!1),A=u=>{y.push({query:{editing:u}})},G=()=>{e.value.publishing_state="pbsh",$(e.value.id,e.value)},V=(u,o)=>{e.value=o,clearTimeout(b.value),b.value=setTimeout(async()=>{try{await $(u,e.value)}catch(n){console.log("An error : ",n)}},1e3)},q=u=>{u!=`
`&&V(M(d).id.value,{...e.value,content:u})},{user:B}=z(),j=W(()=>B.value?e.value.author_id==B.value.id:!1),{getCommentsForThoughtOutput:J}=ae(),F=c([]);return C(async()=>{e.value=await k(d.id),F.value=await J(d.id);const u=h.query.editing;w.value=u==="false"?!1:!!u}),(u,o)=>e.value?(s(),p("div",ge,[w.value?(s(),p("div",Ce,[e.value.output_type=="atcl"?(s(),f(te,{key:0,article:e.value,onChange:o[1]||(o[1]=n=>V(e.value.id,n))},null,8,["article"])):(s(),f(he,{key:1,problem:e.value,onChange:o[2]||(o[2]=n=>V(e.value.id,n))},null,8,["problem"])),r("div",Te,[i(x,{class:"mx-4",onClick:o[3]||(o[3]=n=>A(!1)),type:"valid",text:"Preview"},{default:U(()=>[Z("Ok")]),_:1}),e.value.publishing_state=="drft"?(s(),f(x,{key:0,onClick:G,type:"valid",text:"Publier"})):(s(),p("div",we,"Publié"))])])):(s(),p("div",_e,[r("div",fe,[r("img",{src:e.value.image_url,class:"border border-slate-300 dark:border-zinc-700 rounded-xl ml-auto mr-auto"},null,8,be)]),r("h1",ye,I(e.value.title),1),r("div",xe,I(e.value.description),1),j.value?(s(),f(X,{key:0,onClick:o[0]||(o[0]=n=>A(!0))},{default:U(()=>[i(N(ne),{class:"m-1"})]),_:1})):L("",!0),r("div",ke,[i(Y,{"progress-value":e.value.progress,class:"m-2 w-1/3"},null,8,["progress-value"]),r("a",{class:"ml-auto underline",href:e.value.gdoc_url}," Ajouter un commentaire ",8,$e)])])),r("div",null,[i(pe,{choices:m.value,default:"ctnt"},null,8,["choices"])]),Ve,a.value=="ctnt"?(s(),p("div",Ue,[e.value.publishing_state!="drft"?(s(),f(ue,{key:0,"ext-comments":F.value,"ressource-id":e.value.id,"full-text":e.value.content,editable:j.value,onChange:o[4]||(o[4]=n=>q(n))},null,8,["ext-comments","ressource-id","full-text","editable"])):(s(),f(S,{key:1,class:"h-96",label:"Contenu",modelValue:e.value.content,"onUpdate:modelValue":o[5]||(o[5]=n=>q(n))},null,8,["modelValue"]))])):(s(),p("div",Oe,[i(se,{open:g.value,onClose:o[7]||(o[7]=n=>g.value=!1)},{default:U(()=>[i(de,{onRefresh:v,onClose:o[6]||(o[6]=n=>g.value=!1),"thought-output":e.value},null,8,["thought-output"])]),_:1},8,["open"]),r("div",{onClick:o[8]||(o[8]=n=>g.value=!0),class:"text-sm italic underline"}," Ajouter une référence "),i(E,{"thought-inputs":t.value.map(n=>n.thought_input)},null,8,["thought-inputs"])]))])):L("",!0)}});export{Pe as default};
