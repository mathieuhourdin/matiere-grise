import{o as l,c as m,f as n,d as C,r as p,l as $,t as I,u as M,i as f,h as i,_ as k,e as N,m as z,n as R,F as Q,p as W,q as P,s as X,w as U,v as Y,a as D,x as Z,y as ee,z as L}from"./index-2eaf9e6b.js";import{a as S,b as te,_ as oe}from"./ArticleForm.vue_vue_type_script_setup_true_lang-fa0f0878.js";import{_ as E,u as se,a as le}from"./ModalSheet.vue_vue_type_script_setup_true_lang-44269729.js";import{u as H,a as ue}from"./useThoughtOutput-2714ac0f.js";import{_ as ae,u as ne}from"./TextInterface.vue_vue_type_script_setup_true_lang-23522b52.js";import{_ as O}from"./TextInput.vue_vue_type_script_setup_true_lang-dc553369.js";function re(_,d){return l(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}const ie={key:1},de={class:"flex flex-row-reverse"},ce=C({__name:"CreateThoughtInputUsageForm",props:{thoughtOutput:{}},emits:["close","refresh"],setup(_,{emit:d}){const v=_,{user:h}=N(),a=p([]),s=p(null),o=p(""),{createThoughtInputUsage:b}=H(),c=async()=>{console.log("create");const y={thought_output_id:v.thoughtOutput.id,thought_input_id:s.value.id,usage_reason:o.value};await b(y),d("refresh"),d("close")},{getUserThoughtInputs:x}=se(),T=y=>{s.value=y};return $(async()=>a.value=await x(h.value.id)),(y,g)=>(l(),m("div",null,[n("div",null,I(M(h).first_name),1),s.value?(l(),m("div",ie,[i(S,{label:"Pourquoi ajouter cet élément ?",modelValue:o.value,"onUpdate:modelValue":g[1]||(g[1]=e=>o.value=e)},null,8,["modelValue"]),n("div",de,[i(k,{type:"valid",onClick:c,text:"Ajouter"}),i(k,{type:"abort",onClick:g[2]||(g[2]=e=>d("close")),text:"Ajouter"})])])):(l(),f(E,{key:0,"thought-inputs":a.value,center:"",onSelect:g[0]||(g[0]=e=>T(e))},null,8,["thought-inputs"]))]))}}),pe={class:"mx-auto flex flex-wrap max-w-full"},me=C({__name:"ToggleButtonGroup",props:{choices:{},default:{}},setup(_){const d=_,v=p(null),h=z(),a=R(),s=o=>{v.value=o;const b=a.query,c=a.path;h.push({path:c,query:{...b,tab:o}}),console.log(`route : ${JSON.stringify(a)}`)};return $(()=>s(d.default)),(o,b)=>(l(),m("div",pe,[(l(!0),m(Q,null,W(o.choices,c=>(l(),f(k,{key:c.value,class:"w-24 mx-auto my-1 md:mx-1",text:c.text,onClick:x=>s(c.value),type:c.value==v.value?"valid":"abort"},null,8,["text","onClick","type"]))),128))]))}}),ve={class:"flex"},he={class:"flex"},ge=C({__name:"ProblemForm",props:{problem:{}},emits:["change"],setup(_,{emit:d}){const v=_,h=(a,s)=>{let o={...v.problem};o[a]=s,d("change",o)};return(a,s)=>(l(),m("div",null,[i(O,{label:"Titre",modelValue:a.problem.title,"onUpdate:modelValue":s[0]||(s[0]=o=>h("title",o))},null,8,["modelValue"]),i(O,{class:"h-6",label:"Description",modelValue:a.problem.description,"onUpdate:modelValue":s[1]||(s[1]=o=>h("description",o))},null,8,["modelValue"]),n("div",ve,[i(te,{class:"mr-auto h-6",label:"Progression",modelValue:a.problem.progress,"onUpdate:modelValue":s[2]||(s[2]=o=>h("progress",o))},null,8,["modelValue"])]),n("div",he,[i(O,{class:"h-6",label:"Lien image",modelValue:a.problem.image_url,"onUpdate:modelValue":s[3]||(s[3]=o=>h("image_url",o))},null,8,["modelValue"])])]))}}),_e={key:0,class:"px-8 mx-auto"},fe={key:0},be={class:"my-8"},ye=["src"],xe={class:"text-3xl my-3 font-mplus md:text-center text-left"},ke={class:"md:text-center text-left"},$e={class:"md:flex my-8"},Ce=["href"],Te={key:1},we={class:"flex flex-row-reverse"},Ve={key:1,class:"p-2 border rounded bg-neutral-100"},Ue=n("hr",{class:"border-top border-zinc-400 my-4"},null,-1),Oe={key:2},Ie={key:3},De=C({__name:"SeeArticle",props:{id:{}},setup(_){const d=_,v=R(),h=p([{text:"Contenu",value:"ctnt"},{text:"Biblio",value:"bbli"}]),a=p(v.query.tab),s=p(null);P(()=>v.query.tab,u=>{console.log("new route query",u),s.value=u});const{getThoughtInputUsagesForThoughtOutput:o}=H(),b=p([]),c=p(!1),x=async()=>{const u=await o(L(d).id.value);b.value=u.map(t=>({...t.thought_input,usage_reason:t.usage_reason}))};$(()=>x());const{getThoughtOutput:T,updateThoughtOutput:y}=ue(),g=p(null),e=p(null),G=z();P(()=>v.query.editing,u=>{console.log("Editing : ",u),w.value=u==="false"?!1:!!u});const w=p(!1),q=u=>{G.push({query:{editing:u}})},J=()=>{e.value.publishing_state="pbsh",y(e.value.id,e.value)},V=(u,t)=>{e.value=t,clearTimeout(g.value),g.value=setTimeout(async()=>{try{await y(u,e.value)}catch(r){console.log("An error : ",r)}},1e3)},A=u=>{u!=`
`&&V(L(d).id.value,{...e.value,content:u})},{user:B}=N(),j=X(()=>B.value?e.value.author_id==B.value.id:!1),{getCommentsForThoughtOutput:K}=ne(),F=p([]);return $(async()=>{e.value=await T(d.id),F.value=await K(d.id);const u=v.query.editing;w.value=u==="false"?!1:!!u}),(u,t)=>e.value?(l(),m("div",_e,[w.value?(l(),m("div",Te,[e.value.output_type=="atcl"?(l(),f(oe,{key:0,article:e.value,onChange:t[1]||(t[1]=r=>V(e.value.id,r))},null,8,["article"])):(l(),f(ge,{key:1,problem:e.value,onChange:t[2]||(t[2]=r=>V(e.value.id,r))},null,8,["problem"])),n("div",we,[i(k,{class:"mx-4",onClick:t[3]||(t[3]=r=>q(!1)),type:"valid",text:"Preview"},{default:U(()=>[ee("Ok")]),_:1}),e.value.publishing_state=="drft"?(l(),f(k,{key:0,onClick:J,type:"valid",text:"Publier"})):(l(),m("div",Ve,"Publié"))])])):(l(),m("div",fe,[n("div",be,[n("img",{src:e.value.image_url,class:"border border-slate-300 dark:border-zinc-700 rounded-xl ml-auto mr-auto"},null,8,ye)]),n("h1",xe,I(e.value.title),1),n("div",ke,I(e.value.description),1),j.value?(l(),f(Y,{key:0,onClick:t[0]||(t[0]=r=>q(!0))},{default:U(()=>[i(M(re),{class:"m-1"})]),_:1})):D("",!0),n("div",$e,[i(Z,{"progress-value":e.value.progress,class:"m-2 w-1/3"},null,8,["progress-value"]),n("a",{class:"ml-auto underline",href:e.value.gdoc_url}," Ajouter un commentaire ",8,Ce)])])),n("div",null,[i(me,{choices:h.value,default:a.value},null,8,["choices","default"])]),Ue,s.value=="ctnt"?(l(),m("div",Oe,[e.value.publishing_state!="drft"?(l(),f(ae,{key:0,"ext-comments":F.value,"ressource-id":e.value.id,"full-text":e.value.content,editable:j.value,onChange:t[4]||(t[4]=r=>A(r))},null,8,["ext-comments","ressource-id","full-text","editable"])):(l(),f(S,{key:1,class:"h-96",label:"Contenu",modelValue:e.value.content,"onUpdate:modelValue":t[5]||(t[5]=r=>A(r))},null,8,["modelValue"]))])):(l(),m("div",Ie,[i(le,{open:c.value,onClose:t[7]||(t[7]=r=>c.value=!1)},{default:U(()=>[i(ce,{onRefresh:x,onClose:t[6]||(t[6]=r=>c.value=!1),"thought-output":e.value},null,8,["thought-output"])]),_:1},8,["open"]),n("div",{onClick:t[8]||(t[8]=r=>c.value=!0),class:"text-sm italic underline"}," Ajouter une référence "),i(E,{"thought-inputs":b.value},null,8,["thought-inputs"])]))])):D("",!0)}});export{De as default};
