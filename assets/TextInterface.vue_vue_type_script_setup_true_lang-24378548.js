import{e as z,r as s,g as I,h as P,m,l as R,o as r,c as n,n as W,k as D,F as y,p as C,q as K,b as L,t as N}from"./index-ffacdf5a.js";const O=["onClick"],S={key:0,style:{width:"5px"}},V={key:1,style:{height:"25px"}},q={key:2},X=z({__name:"TextInterface",props:{fullText:{}},emits:["change"],setup(k,{emit:_}){const h=k,u=e=>{console.log("selectCursorPosition letter : ",e),a.value={id:e.id,char:e.char}},a=s(null),o=s([]),b=I(()=>{console.log("Compute lines");let e=[{id:0,text:[]}].concat(o.value.filter(l=>l.char==`
`));console.log("Compute ids.length : ",e.length);for(let l=0;l<e.length-1;l++)console.log("Compute line : ",l),e[l].text=o.value.filter(t=>t.id>=e[l].id&&t.id<e[l+1].id);return e[e.length-1].text=o.value.filter(l=>l.id>=e[e.length-1].id),e}),c=e=>{o.value.filter(l=>l.id>=a.value.id+1).forEach(l=>l.id+=1),o.value.splice(a.value.id+1,0,{id:a.value.id+1,char:e,line:0}),a.value.id+=1},w=e=>{if(console.log("Writes : ",e.key),a.value===null)return;const l=e.key;if(d.value&&l=="v"){T();return}if(l.length==1)c(l);else if(l=="Backspace")o.value.splice(a.value.id,1),o.value.filter(t=>t.id>a.value.id).forEach(t=>t.id-=1),a.value.id-=1;else if(l=="Enter")c(`
`);else if(l=="ArrowRight"){let t=a.value.id;t<o.value.length-1&&u(o.value[t+1])}else if(l=="ArrowLeft"){let t=a.value.id;t>0&&u(o.value[t-1])}else l=="Control"&&(console.log("Control"),d.value=!0)},d=s(!1),T=async()=>{try{let l=await navigator.clipboard.readText();console.log("Clippedtext : ",l);for(var e=0;e<l.length;e++)c(l[e])}catch(l){console.log("Error with clippboard : ",l)}},E=e=>{e.key=="Control"&&(d.value=!1)},v=s(!1),f=s({position:"absolute","z-index":90,top:0,left:0,height:"100px",width:"150px"}),A=e=>{e.preventDefault(),f.value.top=`${e.layerY}px`,f.value.left=`${e.layerX}px`,v.value=!0,console.log("event : ",e),console.log("Have a new right click")},p=e=>{if(console.log("textArrayFromString textString: ",e),o.value=[],e===void 0||e==""){o.value=[{id:0,char:`
`}],u({id:0,char:`
`});return}for(var l=0;l<e.length;l++)o.value.push({id:l,char:e[l]})},B=e=>e.reduce((l,t)=>l+t.char,""),g=s(!1);return P(()=>{p(h.fullText),g.value=!0}),m(o,e=>{console.log("Watch triggered : ",e),g.value&&_("change",B(e))},{deep:!0}),m(R(h).fullText,e=>{p(e)}),(e,l)=>(r(),n("div",{class:"border-2 mx-auto relative p-4",tabindex:"0",onKeydown:w,onKeyup:E,onClick:l[0]||(l[0]=t=>v.value=!1)},[v.value?(r(),n("div",{key:0,class:"bg-white border-4",style:W(f.value)},null,4)):D("",!0),(r(!0),n(y,null,C(b.value,(t,F)=>(r(),n("div",{key:F,class:"flex flex-wrap w-full"},[(r(!0),n(y,null,C(t.text,(i,$)=>{var x;return r(),n("div",{key:$,class:K(["border-blue-400",{"border-r-2":i.id==((x=a.value)==null?void 0:x.id)}]),onClick:H=>u(i),onContextmenu:A},[i.char==" "?(r(),n("div",S)):i.char==`
`?(r(),n("div",V)):(r(),n("div",q,[L("div",null,N(i.char),1)]))],42,O)}),128))]))),128))],32))}});export{X as _};
