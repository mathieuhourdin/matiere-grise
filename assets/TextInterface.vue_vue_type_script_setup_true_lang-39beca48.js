import{e as L,r as s,g as P,h as R,m as k,l as D,o as n,c as a,n as K,k as N,F as p,p as g,q as O,b as S,t as V}from"./index-c23a212a.js";const q=["onClick"],G={key:0,style:{width:"5px"}},H={key:1,style:{height:"25px"}},M={key:2},j=L({__name:"TextInterface",props:{fullText:{}},emits:["change"],setup(w,{emit:_}){const x=w,u=l=>{console.log("selectCursorPosition letter : ",l),r.value={id:l.id,char:l.char}},r=s(null),o=s([]),b=P(()=>{console.log("Compute lines");let l=[{id:0,text:[]}].concat(o.value.filter(e=>e.char==`
`));console.log("Compute ids.length : ",l.length);for(let e=0;e<l.length-1;e++)console.log("Compute line : ",e),l[e].text=o.value.filter(t=>t.id>=l[e].id&&t.id<l[e+1].id);return l[l.length-1].text=o.value.filter(e=>e.id>=l[l.length-1].id),l.forEach(e=>{console.log("Line : ",e),e.words=E(e.text)}),l}),E=l=>{let e=l.filter(t=>t.char==" ");console.log("Words : ",e);for(let t=0;t<e.length;t++)e[t].text=l.filter(c=>c.id>=e[t].id&&(t==e.length-1||c.id<e[t+1].id));return e},d=l=>{o.value.filter(e=>e.id>=r.value.id+1).forEach(e=>e.id+=1),o.value.splice(r.value.id+1,0,{id:r.value.id+1,char:l,line:0}),r.value.id+=1},B=l=>{if(console.log("Writes : ",l.key),r.value===null)return;const e=l.key;if(v.value&&e=="v"){T();return}if(e.length==1)d(e);else if(e=="Backspace")o.value.splice(r.value.id,1),o.value.filter(t=>t.id>r.value.id).forEach(t=>t.id-=1),r.value.id-=1;else if(e=="Enter")d(`
`);else if(e=="ArrowRight"){let t=r.value.id;t<o.value.length-1&&u(o.value[t+1])}else if(e=="ArrowLeft"){let t=r.value.id;t>0&&u(o.value[t-1])}else e=="Control"&&(console.log("Control"),v.value=!0)},v=s(!1),T=async()=>{try{let e=await navigator.clipboard.readText();console.log("Clippedtext : ",e);for(var l=0;l<e.length;l++)d(e[l])}catch(e){console.log("Error with clippboard : ",e)}},W=l=>{l.key=="Control"&&(v.value=!1)},f=s(!1),h=s({position:"absolute","z-index":90,top:0,left:0,height:"100px",width:"150px"}),A=l=>{l.preventDefault(),h.value.top=`${l.layerY}px`,h.value.left=`${l.layerX}px`,f.value=!0,console.log("event : ",l),console.log("Have a new right click")},y=l=>{if(console.log("textArrayFromString textString: ",l),o.value=[],l===void 0||l==""){o.value=[{id:0,char:`
`}],u({id:0,char:`
`});return}for(var e=0;e<l.length;e++)o.value.push({id:e,char:l[e]})},F=l=>l.reduce((e,t)=>e+t.char,""),m=s(!1);return R(()=>{y(x.fullText),m.value=!0}),k(o,l=>{console.log("Watch triggered : ",l),m.value&&_("change",F(l))},{deep:!0}),k(D(x).fullText,l=>{y(l)}),(l,e)=>(n(),a("div",{class:"border-2 mx-auto relative p-4",tabindex:"0",onKeydown:B,onKeyup:W,onClick:e[0]||(e[0]=t=>f.value=!1)},[f.value?(n(),a("div",{key:0,class:"bg-white border-4",style:K(h.value)},null,4)):N("",!0),(n(!0),a(p,null,g(b.value,(t,c)=>(n(),a("div",{key:c,class:"flex flex-wrap w-full"},[(n(!0),a(p,null,g(t.words,($,z)=>(n(),a("div",{key:z,class:"flex flex-wrap"},[(n(!0),a(p,null,g($.text,(i,I)=>{var C;return n(),a("div",{key:I,class:O(["border-blue-400",{"border-r-2":i.id==((C=r.value)==null?void 0:C.id)}]),onClick:X=>u(i),onContextmenu:A},[i.char==" "?(n(),a("div",G)):i.char==`
`?(n(),a("div",H)):(n(),a("div",M,[S("div",null,V(i.char),1)]))],42,q)}),128))]))),128))]))),128))],32))}});export{j as _};
