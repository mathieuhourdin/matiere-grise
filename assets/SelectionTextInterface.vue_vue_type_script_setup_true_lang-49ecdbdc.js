import{o as p,f as g,a as R,d as E,b as v,i as B,D as $,n as M,A as I,h as O,e as J,j as L,C as W,F as q,g as G,t as S}from"./index-292dcd80.js";function Q(l,a){return p(),g("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[R("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})])}const X=E({__name:"ClipboardButton",props:{text:{}},setup(l){const a=l,c=v(!1),{launchSnackbar:u}=I(),r=async()=>{try{await navigator.clipboard.writeText(a.text),c.value=!0,u("Text copied to clipboard","success"),setTimeout(()=>c.value=!1,2e3)}catch(w){console.log(`Error with copy : ${w}`)}};return(w,b)=>(p(),g("div",null,[B(M(Q),{onClick:r,class:$({"text-slate-400":c.value})},null,8,["class"])]))}});let f;const Y=new Uint8Array(16);function Z(){if(!f&&(f=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!f))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return f(Y)}const s=[];for(let l=0;l<256;++l)s.push((l+256).toString(16).slice(1));function ee(l,a=0){return s[l[a+0]]+s[l[a+1]]+s[l[a+2]]+s[l[a+3]]+"-"+s[l[a+4]]+s[l[a+5]]+"-"+s[l[a+6]]+s[l[a+7]]+"-"+s[l[a+8]]+s[l[a+9]]+"-"+s[l[a+10]]+s[l[a+11]]+s[l[a+12]]+s[l[a+13]]+s[l[a+14]]+s[l[a+15]]}const te=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),U={randomUUID:te};function ne(l,a,c){if(U.randomUUID&&!a&&!l)return U.randomUUID();l=l||{};const u=l.random||(l.rng||Z)();if(u[6]=u[6]&15|64,u[8]=u[8]&63|128,a){c=c||0;for(let r=0;r<16;++r)a[c+r]=u[r];return a}return ee(u)}const le={class:""},ae=R("div",{class:"cursor bg-blue-400"},null,-1),oe=[ae],ie=["onClick","id"],se={key:0},ce={key:1,class:"ml-4"},re=E({__name:"SelectionTextInterface",props:{text:{},editable:{type:Boolean}},emits:["change"],setup(l,{emit:a}){const c=l,{launchSnackbar:u}=I(),r=v(""),w=O(()=>_()),b=v(null),V=t=>{if(!c.editable)return;const i=window.getSelection().getRangeAt(0);e.value={line:t,charRange:i.startOffset}},T=()=>{if(e.value.line===void 0)return;console.log(`CursorPosition : ${JSON.stringify(e.value)}`);const t=document.createRange(),n=document.getElementById(`line-${r.value}-${e.value.line}`);console.log("Selected LIne : ",n);const i=window.getComputedStyle(n).lineHeight,d=n.firstChild.firstChild;t.setStart(d,0),t.setEnd(d,e.value.charRange);const h=t.getClientRects(),x=h[h.length-1];k.value={left:`${x.right}px`,bottom:`${x.bottom}px`,top:`${x.top-3}px`,height:i}},A=(t,n,i)=>t.slice(0,i)+n+t.slice(i),D=(t,n)=>t.slice(0,n-1)+t.slice(n),m=v(0),N=async()=>{if(e.value.charRange!==0)o.value[e.value.line].text=D(o.value[e.value.line].text,e.value.charRange),e.value.charRange-=1;else{if(o.value[e.value.line].chip){o.value[e.value.line].chip=!1,m.value+=1;return}if(o.value[e.value.line].chip){o.value[e.value.line].chip=!1,m.value+=1;return}if(e.value.line===0)return;await new Promise(t=>setTimeout(t,10)),e.value={line:e.value.line-1,charRange:o.value[e.value.line-1].text.length},o.value[e.value.line].text+=o.value[e.value.line+1].text,o.value.splice(e.value.line+1,1)}m.value+=1},P=t=>{b.value==="Dead"&&(t="Ãª"),t==="#"&&e.value.charRange===0?o.value[e.value.line].bold=!0:t==="*"&&e.value.charRange===0?o.value[e.value.line].chip=!0:(o.value[e.value.line].text=A(o.value[e.value.line].text,t,e.value.charRange),e.value.charRange+=1),m.value+=1},H=async()=>{const t=e.value.line,n=e.value.charRange,i=o.value[e.value.line].text,d=i.slice(0,n),x={index:440,text:i.substring(n,i.length),bold:!1,chip:!1};o.value.splice(t+1,0,x),await new Promise(z=>setTimeout(z,10)),e.value={line:t+1,charRange:0},o.value[t].text=d,m.value+=1},j=async t=>{const n=t.key;t.preventDefault(),console.log("Keydown : ",n),n.length===1?P(n):n==="Enter"?await H():n==="Backspace"?await N():n==="ArrowRight"?e.value.charRange===o.value[e.value.line].text.length?e.value={line:e.value.line+1,charRange:1}:e.value.charRange+=1:n==="ArrowLeft"&&(e.value.charRange===0?e.value={line:e.value.line-1,charRange:o.value[e.value.line-1].text.length}:e.value.charRange-=1),b.value=n},k=v({left:"0px",right:"0px"}),e=v({line:void 0,charRange:void 0}),o=v([]),F=t=>t.split(`
`).map((n,i)=>{let d=!1,h=!1;return n[0]==="#"&&(n=n.slice(1),d=!0),n[0]==="*"&&(n=n.slice(1),h=!0),{index:i,text:n,bold:d,chip:h}}),_=()=>o.value.map(t=>(t.bold?"#":"")+(t.chip?"*":"")+t.text).join(`
`),y=v(null);J(()=>{r.value=ne(),o.value=F(c.text),y.value=document.getElementById("editor-interface"),y.focus,y.value.addEventListener("blur",()=>{y.value.focus()}),document.getElementById("router-view").addEventListener("scroll",()=>{T()})});const C=v(null),K=()=>{C.value!==null&&clearTimeout(C.value),C.value=setTimeout(async()=>{const t=_();t===""||!t?u("Try to update with empty content","error"):a("change",_())},1e3)};return L(m,()=>{K()}),L(e,()=>{T()},{deep:!0}),(t,n)=>(p(),g("div",le,[R("div",{style:W(k.value),class:"absolute flex flex-column"},oe,4),B(X,{class:"ml-auto h-6 w-6",text:w.value},null,8,["text"]),R("div",{id:"editor-interface",tabindex:"0",onKeydown:n[0]||(n[0]=i=>j(i))},[(p(!0),g(q,null,G(o.value,(i,d)=>(p(),g("div",{class:$(["whitespace-pre-wrap",{"font-bold":i.bold}]),onClick:h=>V(d),id:`line-${r.value}-${d}`},[i.chip?(p(),g("li",ce,S(i.text),1)):(p(),g("div",se,S(i.text===""?" ":i.text),1))],10,ie))),256))],32)]))}});export{X as _,re as a};
