import{o as l,c as p,h as a,d as I,t as w,r as h,v as F,f as N,j as i,e as L,A as he,y as H,B as J,k as fe,C as ye,D as be,a as k,q as ae,w as U,g as K,E as le,m as V,F as re,i as ue,G as we,n as R,u as O,l as q,x as xe,H as ke,s as $e,I as Ie,z as X}from"./index-1f519ece.js";import{_ as Y,u as Ve}from"./TextInterface.vue_vue_type_script_setup_true_lang-030fb6c6.js";import{_ as B}from"./TextInput.vue_vue_type_script_setup_true_lang-47228b38.js";import{u as Ce}from"./useResource-2c4f22fd.js";import{u as ie}from"./useThoughtInputUsages-ba79821a.js";function Ue(n,e){return l(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 8.25H7.5a2.25 2.25 0 00-2.25 2.25v9a2.25 2.25 0 002.25 2.25h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25H15M9 12l3 3m0 0l3-3m-3 3V2.25"})])}function Re(n,e){return l(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}function De(n,e){return l(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"})])}const Te={class:"m-4"},Se={class:"block text-2xs text-slate-800"},Ae=["value","placeholder"],W=I({__name:"TextAreaInput",props:{label:{},modelValue:{},placeholder:{}},emits:["update:modelValue"],setup(n,{emit:e}){const o=t=>{e("update:modelValue",t.target.value)};return(t,u)=>(l(),p("div",Te,[a("label",Se,w(t.label),1),a("textarea",{class:"border border-neutral-800 block h-full w-full",value:t.modelValue,placeholder:t.placeholder,onInput:u[0]||(u[0]=r=>o(r))},null,40,Ae)]))}}),Be=a("hr",{class:"border-top border-zinc-400 my-4"},null,-1),Fe=a("div",{class:"text-xs italic"},"Raison de la lecture",-1),Ne=I({__name:"SeeThoughtInput",props:{thoughtInput:{}},setup(n){const e=n,{getUserById:o,user:t}=L(),u=h(null),r=F(()=>t.value?e.thoughtInput.interaction_user_id===t.value.id:!1);return N(async()=>{e.thoughtInput.interaction_user_id&&(u.value=await o(e.thoughtInput.interaction_user_id))}),(s,_)=>(l(),p("div",null,[i(Yt,{id:s.thoughtInput.resource_id,"second-level":""},null,8,["id"]),Be,Fe,i(Y,{"full-text":s.thoughtInput.interaction_comment,editable:r.value},null,8,["full-text","editable"])]))}}),Oe={class:"flex"},Z=I({__name:"ModalSheet",props:{open:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:e}){const o=n,t=h(!1);return N(()=>{t.value=o.open}),he(()=>{const u=r=>{(r.key==="Escape"||r.key==="Enter"||r.key==="Esc"||r.keyCode===27)&&e("close")};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}}),H(J(o).open,u=>t.value=u),(u,r)=>t.value?(l(),p("div",{key:0,tabindex:"0",onKeyup:r[2]||(r[2]=be(s=>e("close"),["esc"])),class:"fixed top-0 left-0 w-full h-full z-10 bg-slate-500/50",onClick:r[3]||(r[3]=s=>e("close"))},[a("div",{class:"max-w-xl overflow-y-scroll max-h-screen mb-10 bg-white mx-auto mt-6 p-4 rounded shadow",onClick:r[1]||(r[1]=ye(()=>{},["stop"]))},[a("div",Oe,[a("div",{class:"ml-auto",onClick:r[0]||(r[0]=s=>e("close"))},"x")]),fe(u.$slots,"default")])],32)):k("",!0)}}),qe={class:"w-full md:w-96"},Le={key:0,class:"text-xs italic mb-2"},Pe={class:"border shadow-lg rounded p-4 md:w-96"},je={class:"flex"},Ee=["src"],Me={class:"flex flex-wrap w-full",style:{"margin-top":"-8px"}},ze=a("div",{class:"text-2xs italic"}," Nom de l'auteur ",-1),He={class:"ml-auto m-1 w-1/3"},Je={class:"text-2xs"},Ke={class:"flex flex-wrap"},We={key:0,class:"text-2xs italic"},Ge=I({__name:"ThoughtInputCard",props:{thoughtInput:{},usageReason:{}},setup(n){const e=n,{getUserById:o}=L(),t=h(null);N(async()=>{e.thoughtInput.interaction_user_id&&(t.value=await o(e.thoughtInput.interaction_user_id))});const u=s=>s.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}),r=s=>s.length>200?s.slice(0,150)+"...":s;return(s,_)=>{const c=ae("router-link");return l(),p("div",qe,[s.usageReason?(l(),p("div",Le,w(s.usageReason),1)):k("",!0),a("div",Pe,[a("div",je,[s.thoughtInput.resource?(l(),p("img",{key:0,class:"w-8 h-fit mr-4",src:s.thoughtInput.resource.image_url},null,8,Ee)):k("",!0),a("div",null,[a("div",null,[i(c,{to:"/thought_inputs/"+s.thoughtInput.id},{default:U(()=>[K(w(s.thoughtInput.resource.title),1)]),_:1},8,["to"])]),a("div",Me,[ze,a("div",He,[i(le,{"progress-value":s.thoughtInput.interaction_progress},null,8,["progress-value"])])]),a("div",Je,w(r(s.thoughtInput.interaction_comment)),1)])]),a("div",Ke,[s.thoughtInput.interaction_date?(l(),p("div",We,w(u(s.thoughtInput.interaction_date)),1)):k("",!0),t.value?(l(),V(c,{key:1,to:"/users/"+t.value.id,class:"ml-auto text-2xs underline"},{default:U(()=>[K(w(t.value.first_name)+" "+w(t.value.last_name),1)]),_:1},8,["to"])):k("",!0)])])])}}}),Qe={class:"w-fit"},Xe=I({__name:"ThoughtInputCardWithPopup",props:{thoughtInput:{},usageReason:{}},setup(n){const e=h(!1);return(o,t)=>(l(),p("div",Qe,[i(Z,{open:e.value,onClose:t[0]||(t[0]=u=>e.value=!1)},{default:U(()=>[i(Ne,{"thought-input":o.thoughtInput,"usage-reason":o.usageReason},null,8,["thought-input","usage-reason"])]),_:1},8,["open"]),i(Ge,{class:"md:w-96","thought-input":o.thoughtInput,"usage-reason":o.usageReason,onClick:t[1]||(t[1]=u=>e.value=!0)},null,8,["thought-input","usage-reason"])]))}}),Ye={class:"relative max-w-full"},Ze={key:0,class:"absolute md:border h-full start-1/2"},ce=I({__name:"ThoughtInputsList",props:{thoughtInputs:{},usageReasons:{},center:{type:Boolean,default:!1}},emits:["select"],setup(n,{emit:e}){const o=n,t=s=>{if(o.usageReasons&&o.usageReasons.length===o.thoughtInputs.length)return o.usageReasons[s]},u=s=>s.sort((_,c)=>+(c.interaction_date>_.interaction_date)),r=s=>{console.log("Select"),e("select",s)};return(s,_)=>(l(),p("div",Ye,[s.center?k("",!0):(l(),p("div",Ze)),(l(!0),p(re,null,ue(u(s.thoughtInputs),(c,d)=>(l(),V(Xe,{key:c.id,class:we(["mb-4 md:mb-1 mx-auto max-w-full max-w-fit p-1",{"md:ml-0":d%2==0&&!s.center,"md:mr-0":!s.center}]),"thought-input":c,"usage-reason":t(d),onClick:x=>r(c)},null,8,["class","thought-input","usage-reason","onClick"]))),128))]))}});function et(){const n={title:"",subtitle:"",content:"",external_content_url:"",publishing_state:"pbsh",maturing_state:"fnsh",image_url:"",resource_type:"",comment:""};return{interaction_progress:0,interaction_date:new Date(Date.now()),interaction_comment:"",interaction_is_public:!0,resource:n}}function G(n){return console.log("Date : ",n.interaction_date),n.interaction_date=new Date(n.interaction_date),n}async function tt(){return(await R.get("/thought_inputs")).data.map(e=>G(e))}async function nt(n){const e=await R.get("/thought_inputs/"+n);return G(e.data)}async function ot(n){return(await R.get("/users/"+n+"/thought_inputs")).data.map(o=>G(o))}async function st(n){const e=new Date(n.interaction_date);console.log("Date : ",e);const o=e.toISOString().split(".")[0];n.interaction_progress=Number(n.interaction_progress);const t=await R.post("/thought_inputs",{...n,interaction_date:o});return G(t.data)}function at(){return{getUserThoughtInputs:ot,newThoughtInput:et,createThoughtInput:st,getThoughtInputs:tt,getThoughtInput:nt}}const lt={key:0},rt={key:2},ut={class:"flex flex-row-reverse"},it=I({__name:"CreateThoughtInputUsageForm",props:{thoughtOutput:{}},emits:["close","refresh"],setup(n,{emit:e}){const o=n,{user:t}=L(),u=h([]),r=h(null),s=h(""),{createThoughtInputUsage:_}=ie(),c=async()=>{if(console.log("create"),!r.value)return;const $={thought_output_id:o.thoughtOutput.id,thought_input_id:r.value.id,usage_reason:s.value};await _($),e("refresh"),e("close")},{getUserThoughtInputs:d}=at(),x=$=>{r.value=$};return N(async()=>{!t.value||!t.value.id||(u.value=await d(t.value.id))}),($,C)=>(l(),p("div",null,[O(t)?(l(),p("div",lt,"Nouvelle utilisation par "+w(O(t).first_name)+" "+w(O(t).last_name),1)):k("",!0),r.value?(l(),p("div",rt,[i(W,{label:"Pourquoi ajouter cet élément ?",modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=S=>s.value=S)},null,8,["modelValue"]),a("div",ut,[i(q,{type:"valid",onClick:c,text:"Ajouter"}),i(q,{type:"abort",onClick:C[2]||(C[2]=S=>e("close")),text:"Ajouter"})])])):(l(),V(ce,{key:1,"thought-inputs":u.value,center:"",onSelect:C[0]||(C[0]=S=>x(S))},null,8,["thought-inputs"]))]))}});function ct(){return{interaction_progress:0,interaction_date:new Date(Date.now()),interaction_comment:"",interaction_is_public:!0}}function P(n){return console.log("Date : ",n.interaction_date),n.interaction_date=new Date(n.interaction_date),n}async function dt(){return(await R.get("/thought_inputs")).data.map(e=>P(e))}async function pt(n){const e=await R.get("/thought_inputs/"+n);return P(e.data)}async function mt(n){return(await R.get("/users/"+n+"/thought_inputs")).data.map(o=>P(o))}async function vt(n,e){const o=new Date(e.interaction_date);console.log("Date : ",o);const t=o.toISOString().split(".")[0];e.interaction_progress=Number(e.interaction_progress);const u=await R.put("/interactions/"+n,{...e,interaction_date:t});return P(u.data)}async function _t(n){const e=new Date(n.interaction_date);console.log("Date : ",e);const o=e.toISOString().split(".")[0];n.interaction_progress=Number(n.interaction_progress);const t=await R.post("/thought_inputs",{...n,interaction_date:o});return P(t.data)}async function gt(n,e){const o=new Date(e.interaction_date);console.log("Date : ",o);const t=o.toISOString().split(".")[0];e.interaction_progress=Number(e.interaction_progress);const u=await R.post(`/resources/${n}/interactions`,{...e,interaction_date:t});return P(u.data)}function de(){return{getUserInteractions:mt,newInteraction:ct,createInteraction:_t,getInteractions:dt,getInteraction:pt,updateInteraction:vt,createInteractionForResource:gt}}const ht={class:"flex flex-row-reverse"},ft=I({__name:"CreateInteraction",props:{resource:{}},emits:["close","refresh"],setup(n,{emit:e}){const o=n,{newInteraction:t,createInteractionForResource:u}=de(),{user:r}=L(),s=h(t()),_=()=>{s.value.resource_id=o.resource.id,s.value.interaction_type="inpt",s.value.interaction_user_id=r.value.id,u(o.resource.id,s.value),e("refresh"),c()},c=()=>e("close");return(d,x)=>(l(),p("div",null,[a("div",null,"Nouvelle interaction, avec la ressource : "+w(d.resource.title),1),i(B,{label:"Avancement de l'ouvrage",modelValue:s.value.interaction_progress,"onUpdate:modelValue":x[0]||(x[0]=$=>s.value.interaction_progress=$),type:"number"},null,8,["modelValue"]),i(B,{label:"Date de lecture",modelValue:s.value.interaction_date,"onUpdate:modelValue":x[1]||(x[1]=$=>s.value.interaction_date=$),type:"date"},null,8,["modelValue"]),i(W,{label:"Pourquoi s'y être interessé ?",modelValue:s.value.interaction_comment,"onUpdate:modelValue":x[2]||(x[2]=$=>s.value.interaction_comment=$)},null,8,["modelValue"]),a("div",ht,[i(q,{onClick:_,class:"m-4",text:"Valider",type:"valid"}),i(q,{onClick:c,class:"m-4",text:"Annuler",type:"abort"})])]))}}),yt=I({__name:"DateField",props:{date:{}},setup(n){const e=n,o=F(()=>new Date(e.date).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}));return(t,u)=>(l(),p("div",null,w(o.value),1))}}),bt={class:"block text-2xs text-slate-800"},wt=["value"],xt=["value"],ee=I({__name:"SelectInput",props:{label:{},choices:{},modelValue:{},displayFunction:{type:Function,default:n=>n.text}},emits:["update:modelValue"],setup(n,{emit:e}){const o=t=>{console.log(t.target.value),e("update:modelValue",t.target.value)};return(t,u)=>(l(),p("div",null,[a("label",bt,w(t.label),1),a("select",{value:t.modelValue,name:"Stade d'écriture",class:"text-xs w-full p-1 block rounded border-2 border-neutral-400",onInput:u[0]||(u[0]=r=>o(r))},[(l(!0),p(re,null,ue(t.choices,r=>(l(),p("option",{key:r.value,value:r.value},w(t.displayFunction(r)),9,xt))),128))],40,wt)]))}}),kt={class:"m-4"},$t={class:"block text-2xs text-slate-800"},It=["value","placeholder"],pe=I({__name:"NumberInput",props:{label:{},modelValue:{},placeholder:{}},emits:["update:modelValue","input"],setup(n,{emit:e}){const o=t=>{e("update:modelValue",t.target.value),e("input",t.target.value)};return(t,u)=>(l(),p("div",kt,[a("label",$t,w(t.label),1),a("input",{class:"border border-neutral-400 block h-full w-full rounded-md border-2 p-1 pl-2 text-xs",type:"number",value:t.modelValue,placeholder:t.placeholder,onInput:u[0]||(u[0]=r=>o(r))},null,40,It)]))}}),Vt={class:"flex"},Ct={class:"ml-auto h-6 m-4 w-1/3"},Ut={class:"ml-auto h-6 m-4 w-1/3"},Rt={class:"flex"},Dt=I({__name:"ArticleForm",props:{article:{}},emits:["change"],setup(n,{emit:e}){const o=n,t=h([{text:"Terminé",value:"fnsh"},{text:"Relecture",value:"rvew"},{text:"Idée",value:"idea"}]),{categories:u}=xe(),r=F(()=>u.value.map(_=>({text:_.display_name,value:_.id}))),s=(_,c)=>{let d={...o.article};d[_]=c,e("change",d)};return(_,c)=>(l(),p("div",null,[i(B,{label:"Titre",modelValue:_.article.title,"onUpdate:modelValue":c[0]||(c[0]=d=>s("title",d))},null,8,["modelValue"]),i(B,{class:"h-6",label:"Sous-titre",modelValue:_.article.subtitle,"onUpdate:modelValue":c[1]||(c[1]=d=>s("subtitle",d))},null,8,["modelValue"]),a("div",Vt,[i(pe,{class:"mr-auto h-6",label:"Progression",modelValue:_.article.interaction_progress,"onUpdate:modelValue":c[2]||(c[2]=d=>s("progress",d))},null,8,["modelValue"]),a("div",Ct,[i(ee,{label:"Catégorie",choices:r.value,"model-value":_.article.category_id,"onUpdate:modelValue":c[3]||(c[3]=d=>s("category_id",d))},null,8,["choices","model-value"])]),a("div",Ut,[i(ee,{label:"Stade d'écriture",choices:t.value,"model-value":_.article.maturing_state,"onUpdate:modelValue":c[4]||(c[4]=d=>s("maturing_state",d))},null,8,["choices","model-value"])])]),a("div",Rt,[i(B,{class:"h-6",label:"Lien contenu externe",modelValue:_.article.external_content_url,"onUpdate:modelValue":c[5]||(c[5]=d=>s("external_content_url",d))},null,8,["modelValue"]),i(B,{class:"h-6",label:"Lien image",modelValue:_.article.image_url,"onUpdate:modelValue":c[6]||(c[6]=d=>s("image_url",d))},null,8,["modelValue"])]),i(W,{label:"Pistes d'amélioration",modelValue:_.article.comment,"onUpdate:modelValue":c[7]||(c[7]=d=>s("comment",d))},null,8,["modelValue"])]))}}),Tt={class:"flex flex-wrap"},St=I({__name:"ResourceAuthorPicker",props:{interaction:{},resourceId:{}},emits:["update"],setup(n,{emit:e}){const o=n,t=h(null),u=h([]),r=v=>{if(v)return{text:`${v.first_name} ${v.last_name}`,value:v.id}},s=F(()=>{var v;return(v=t.value)==null?void 0:v.id}),_=F(()=>{if(u.value)return u.value.map(v=>r(v))}),{getUsers:c,getUserById:d}=L(),x=async v=>t.value=await d(v.interaction_user_id),{createInteractionForResource:$,newInteraction:C,createInteraction:S,updateInteraction:j}=de(),E=async v=>{if(console.log(`newUser : ${JSON.stringify(v)}`),o.interaction){const y={...o.interaction};y.interaction_user_id=v,console.log("newUserid : ",v.id),console.log(`Interaction payload : ${JSON.stringify(y)}`),await j(o.interaction.id,y),e("update")}else{console.log("create interaction");const y=C();y.interaction_user_id=v,y.resource_id=o.resourceId,await $(o.resourceId,y),e("update")}},m=async v=>{await j(o.interaction.id,v),e("update")};return N(async()=>{u.value=await c(),await x(o.interaction)}),H(J(o).interaction,async v=>await x(v)),(v,y)=>(l(),p("div",null,[a("div",Tt,[i(ee,{label:"Auteur",class:"my-auto",choices:_.value,"model-value":s.value,"onUpdate:modelValue":y[0]||(y[0]=D=>E(D))},null,8,["choices","model-value"]),i(B,{class:"my-auto",label:"Date d'écriture","model-value":v.interaction.interaction_date.split("T")[0],"onUpdate:modelValue":y[1]||(y[1]=D=>m({...v.interaction,interaction_date:D})),type:"date"},null,8,["model-value"]),i(pe,{class:"my-auto",label:"Progression",modelValue:v.interaction.interaction_progress,"onUpdate:modelValue":y[2]||(y[2]=D=>m({...v.interaction,interaction_progress:D}))},null,8,["modelValue"])])]))}}),At={key:0,class:"mx-auto"},Bt={key:0},Ft={class:"my-8"},Nt=["src"],Ot={class:"text-3xl my-3 font-mplus md:text-center text-left"},qt={class:"md:text-center text-left"},Lt={class:"md:text-center text-left"},Pt={class:"md:flex my-8"},jt=["href"],Et={key:1},Mt={class:"flex flex-row-reverse"},zt={key:1,class:"p-2 border rounded bg-neutral-100"},Ht=a("hr",{class:"border-top border-zinc-400 my-4"},null,-1),Jt={key:2},Kt=a("div",{class:"text-xs italic"},"Commentaire",-1),Wt=a("hr",{class:"border-top border-zinc-400 my-4"},null,-1),Gt=a("div",{class:"text-xs italic"},"Contenu",-1),Qt={key:3},Xt={class:"fixed right-3 bottom-5"},Yt=I({__name:"ResourceComponent",props:{id:{},secondLevel:{type:Boolean}},setup(n){const e=n,o=ke(),t=F(()=>e.secondLevel?"popup_tab":"tab"),u=h([{text:"Contenu",value:"ctnt"},{text:"Biblio",value:"bbli"}]),r=h(o.query[t.value]&&typeof o.query[t.value]=="string"?o.query[t.value]:"ctnt"),s=h(o.query[t.value]);H(()=>o.query[t.value],f=>{console.log("new route query",f),typeof f=="string"&&(s.value=f)});const{getThoughtInputUsagesForResource:_}=ie(),c=h([]),d=h(!1),x=async()=>{c.value=await _(J(e).id.value)};N(()=>x());const{newResource:$,getResource:C,updateResource:S,getAuthorInteractionForResource:j}=Ce(),E=h(null),m=h($()),v=$e();H(()=>o.query.editing,f=>{console.log("Editing : ",f),y.value=f==="false"?!1:!!f});const y=h(!1),D=f=>{v.push({query:{editing:f.toString()}})},me=()=>{!m.value||!m.value.id||(m.value.publishing_state="pbsh",S(m.value.id,m.value))},te=(f,g)=>{m.value=g,E.value!==null&&clearTimeout(E.value),E.value=setTimeout(async()=>{try{await S(f,m.value)}catch(Q){console.log("An error : ",Q)}},1e3)},ne=f=>{f!=`
`&&te(J(e).id.value,{...m.value,content:f})},{user:oe,getUserById:ve}=L(),M=F(()=>m.value.is_external?!0:!oe.value||!A.value?!1:A.value.id==oe.value.id),A=h(null),T=h(null),z=h(!1),_e=async()=>{T.value=await j(e.id)},{getCommentsForThoughtOutput:ge}=Ve(),se=h([]);return N(async()=>{m.value=await C(e.id),se.value=await ge(e.id),T.value=await j(e.id),T.value&&(A.value=await ve(T.value.interaction_user_id));const f=o.query.editing;y.value=f==="false"?!1:!!f}),(f,g)=>{const Q=ae("router-link");return m.value?(l(),p("div",At,[y.value?(l(),p("div",Et,[i(Dt,{article:m.value,onChange:g[0]||(g[0]=b=>te(m.value.id,b))},null,8,["article"]),i(St,{class:"mx-4",interaction:T.value,"resource-id":f.id,onChange:_e},null,8,["interaction","resource-id"]),a("div",Mt,[i(q,{class:"mx-4",onClick:g[1]||(g[1]=b=>D(!1)),type:"valid",text:"Preview"},{default:U(()=>[K("Ok")]),_:1}),m.value.publishing_state=="drft"?(l(),V(q,{key:0,onClick:me,type:"valid",text:"Publier"})):(l(),p("div",zt,"Publié"))])])):(l(),p("div",Bt,[a("div",Ft,[a("img",{src:m.value.image_url,class:"border border-slate-300 dark:border-zinc-700 rounded-xl ml-auto mr-auto",style:{"max-height":"20rem"}},null,8,Nt)]),a("h1",Ot,w(m.value.title),1),a("div",qt,w(m.value.subtitle),1),a("div",Lt,[A.value?(l(),V(Q,{key:0,to:"/users/"+A.value.id,class:"text-sm underline"},{default:U(()=>[K(w(A.value.first_name)+" "+w(A.value.last_name),1)]),_:1},8,["to"])):k("",!0),T.value?(l(),V(yt,{key:1,date:T.value.interaction_date},null,8,["date"])):k("",!0)]),a("div",Pt,[T.value?(l(),V(le,{key:0,"progress-value":T.value.interaction_progress,class:"m-2 w-1/3"},null,8,["progress-value"])):k("",!0),m.value.resource_type==="atcl"?(l(),p("a",{key:1,class:"ml-auto underline",href:m.value.external_content_url}," Ajouter un commentaire ",8,jt)):k("",!0)])])),a("div",null,[i(Ie,{choices:u.value,default:r.value,"url-key":t.value},null,8,["choices","default","url-key"])]),Ht,s.value=="ctnt"?(l(),p("div",Jt,[Kt,i(Y,{"full-text":m.value.comment,editable:M.value},null,8,["full-text","editable"]),Wt,Gt,m.value.publishing_state!="drft"?(l(),V(Y,{key:0,"ext-comments":se.value,"resource-id":m.value.id,"full-text":m.value.content,editable:M.value,onChange:g[2]||(g[2]=b=>ne(b))},null,8,["ext-comments","resource-id","full-text","editable"])):(l(),V(W,{key:1,class:"h-96",label:"Contenu",modelValue:m.value.content,"onUpdate:modelValue":g[3]||(g[3]=b=>ne(b))},null,8,["modelValue"]))])):(l(),p("div",Qt,[i(Z,{open:d.value,onClose:g[5]||(g[5]=b=>d.value=!1)},{default:U(()=>[i(it,{onRefresh:x,onClose:g[4]||(g[4]=b=>d.value=!1),"thought-output":m.value},null,8,["thought-output"])]),_:1},8,["open"]),a("div",{onClick:g[6]||(g[6]=b=>d.value=!0),class:"text-sm italic underline"}," Ajouter une référence "),i(ce,{"thought-inputs":c.value.map(b=>b.thought_input),"usage-reasons":c.value.map(b=>b.usage_reason)},null,8,["thought-inputs","usage-reasons"])])),a("div",Xt,[M.value?(l(),V(X,{key:0,title:"Modifier",onClick:g[7]||(g[7]=b=>D(!0))},{default:U(()=>[i(O(Re),{class:"m-1"})]),_:1})):k("",!0),M.value?(l(),V(X,{key:1,class:"mt-2",color:"red",title:"Marquer comme lu",onClick:g[8]||(g[8]=b=>z.value=!0)},{default:U(()=>[i(O(Ue),{class:"m-1"})]),_:1})):k("",!0),i(Z,{open:z.value,onClose:g[10]||(g[10]=b=>z.value=!1)},{default:U(()=>[i(ft,{onClose:g[9]||(g[9]=b=>z.value=!1),resource:m.value},null,8,["resource"])]),_:1},8,["open"]),M.value?(l(),V(X,{key:2,class:"mt-2",color:"green",title:"Relier à d'autres ressources",onClick:g[11]||(g[11]=b=>D(!0))},{default:U(()=>[i(O(De),{class:"m-1"})]),_:1})):k("",!0)])])):k("",!0)}}});export{Yt as _,Ne as a,Z as b,ce as c,ee as d,Re as r,at as u};
