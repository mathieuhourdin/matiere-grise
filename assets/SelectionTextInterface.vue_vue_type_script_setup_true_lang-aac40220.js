import{o as u,f as r,a as x,d as T,b as i,i as L,D as B,n as I,A as D,h as q,e as F,j as C,C as J,F as K,g as M,t as k}from"./index-456102ed.js";function O(h,p){return u(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})])}const z=T({__name:"ClipboardButton",props:{text:{}},setup(h){const p=h,o=i(!1),{launchSnackbar:w}=D(),g=async()=>{try{await navigator.clipboard.writeText(p.text),o.value=!0,w("Text copied to clipboard","success"),setTimeout(()=>o.value=!1,2e3)}catch(f){console.log(`Error with copy : ${f}`)}};return(f,b)=>(u(),r("div",null,[L(I(O),{onClick:g,class:B({"text-slate-400":o.value})},null,8,["class"])]))}}),U={class:"md:px-4"},W=x("div",{class:"cursor bg-blue-400"},null,-1),G=[W],Q=["onClick","id"],X={key:0},Y={key:1},ee=T({__name:"SelectionTextInterface",props:{text:{},editable:{type:Boolean}},emits:["change"],setup(h,{emit:p}){const o=h;i(`Ceci est un text d'essai. On va voir ce que ça donne.
Je suis Mathieu Hourdin, j'ai 28 ans, j'habite à paris et j'ai une copine qui s'appelle mathilde. Je veux continuer à rajouter du texte, comme quand je fais des morning pages, ou ma morning routine`);const w=q(()=>y()),g=i(null),f=t=>{if(!o.editable)return;const l=window.getSelection().getRangeAt(0);e.value={line:t,charRange:l.startOffset}},b=()=>{if(e.value.line===void 0)return;console.log(`CursorPosition : ${JSON.stringify(e.value)}`);const t=document.createRange(),a=document.getElementById("line-apetipetou-"+e.value.line);console.log("Selected LIne : ",a);const l=window.getComputedStyle(a).lineHeight,s=a.firstChild.firstChild;t.setStart(s,0),t.setEnd(s,e.value.charRange);const c=t.getClientRects(),d=c[c.length-1];_.value={left:`${d.right}px`,bottom:`${d.bottom}px`,top:`${d.top-3}px`,height:l}},E=(t,a,l)=>t.slice(0,l)+a+t.slice(l),S=(t,a)=>t.slice(0,a-1)+t.slice(a),v=i(0),j=async()=>{if(e.value.charRange!==0)n.value[e.value.line].text=S(n.value[e.value.line].text,e.value.charRange),e.value.charRange-=1;else{if(n.value[e.value.line].chip){n.value[e.value.line].chip=!1,v.value+=1;return}if(n.value[e.value.line].chip){n.value[e.value.line].chip=!1,v.value+=1;return}if(e.value.line===0)return;await new Promise(t=>setTimeout(t,10)),e.value={line:e.value.line-1,charRange:n.value[e.value.line-1].text.length},n.value[e.value.line].text+=n.value[e.value.line+1].text,n.value.splice(e.value.line+1,1)}v.value+=1},A=t=>{g.value==="Dead"&&(t="ê"),t==="#"&&e.value.charRange===0?n.value[e.value.line].bold=!0:t==="*"&&e.value.charRange===0?n.value[e.value.line].chip=!0:(n.value[e.value.line].text=E(n.value[e.value.line].text,t,e.value.charRange),e.value.charRange+=1),v.value+=1},N=async()=>{const t=e.value.line,a=e.value.charRange,l=n.value[e.value.line].text,s=l.slice(0,a),d={index:440,text:l.substring(a,l.length),bold:!1,chip:!1};n.value.splice(t+1,0,d),await new Promise(H=>setTimeout(H,10)),e.value={line:t+1,charRange:0},n.value[t].text=s,v.value+=1},$=async t=>{const a=t.key;t.preventDefault(),console.log("Keydown : ",a),a.length===1?A(a):a==="Enter"?await N():a==="Backspace"?await j():a==="ArrowRight"?e.value.charRange===n.value[e.value.line].text.length?e.value={line:e.value.line+1,charRange:1}:e.value.charRange+=1:a==="ArrowLeft"&&(e.value.charRange===0?e.value={line:e.value.line-1,charRange:n.value[e.value.line-1].text.length}:e.value.charRange-=1),g.value=a},_=i({left:"0px",right:"0px"}),e=i({line:void 0,charRange:void 0}),n=i([]),P=t=>t.split(`
`).map((a,l)=>{let s=!1,c=!1;return a[0]==="#"&&(a=a.slice(1),s=!0),a[0]==="*"&&(a=a.slice(1),c=!0),{index:l,text:a,bold:s,chip:c}}),y=()=>n.value.map(t=>(t.bold?"#":"")+(t.chip?"*":"")+t.text).join(`
`),m=i(null);F(()=>{n.value=P(o.text?`
`+o.text:""),m.value=document.getElementById("editor-interface"),m.focus,m.value.addEventListener("blur",()=>{m.value.focus()}),document.getElementById("router-view").addEventListener("scroll",()=>{b()})});const R=i(null),V=()=>{R.value!==null&&clearTimeout(R.value),R.value=setTimeout(async()=>{p("change",y())},1e3)};return C(v,()=>{V()}),C(e,()=>{b()},{deep:!0}),(t,a)=>(u(),r("div",U,[x("div",{style:J(_.value),class:"absolute flex flex-column"},G,4),L(z,{class:"ml-auto h-6 w-6",text:w.value},null,8,["text"]),x("div",{id:"editor-interface",tabindex:"0",onKeydown:a[0]||(a[0]=l=>$(l))},[(u(!0),r(K,null,M(n.value,(l,s)=>(u(),r("div",{class:B(["whitespace-pre-wrap",{"font-bold":l.bold}]),onClick:c=>f(s),id:"line-apetipetou-"+s},[l.chip?(u(),r("li",Y,k(l.text),1)):(u(),r("div",X,k(l.text),1))],10,Q))),256))],32)]))}});export{z as _,ee as a};
