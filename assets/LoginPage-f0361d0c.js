import{d as V,i as z,u as I,r as x,b as _,c as f,l as e,J as m,a2 as v,t as h,k as S,S as E,U as F,M,y as A,j as L,q as j,a4 as q,f as B,p as U,h as P}from"./index-4b296900.js";const w=c=>(E("data-v-16e295b0"),c=c(),F(),c),N={class:"rounded-2xl border border-slate-700 bg-slate-900/70 p-6 shadow-xl backdrop-blur-sm md:p-7"},T=w(()=>e("div",{class:"mb-6"},[e("h2",{class:"text-xl font-semibold text-slate-100"},"Connexion"),e("p",{class:"mt-2 text-sm text-slate-300"},"Entre ton email et ton mot de passe.")],-1)),D={class:"space-y-5"},J={class:"flex flex-col gap-2"},O=w(()=>e("label",{for:"login-username",class:"text-sm font-medium text-slate-200"},"Email",-1)),R={class:"flex flex-col gap-2"},H=w(()=>e("label",{for:"login-password",class:"text-sm font-medium text-slate-200"},"Mot de passe",-1)),G={key:0,class:"mt-4 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs text-red-200 whitespace-pre-wrap break-words"},K=w(()=>e("div",{class:"font-semibold mb-1"},"Connexion impossible",-1)),Q={class:"mt-6 flex gap-3"},W=["disabled"],X=["disabled"],Y=V({__name:"LoginForm",setup(c){const d=z(),{authUser:i}=I(),a=x(""),o=x(""),t=x(!1),p=x(""),k=()=>{const n=Array.isArray(d.query.redirectPath)?d.query.redirectPath[0]:d.query.redirectPath;return typeof n=="string"&&n.trim().length>0?n:"/"},$=()=>{a.value="",o.value="",p.value=""},C=async()=>{if(!t.value){p.value="",t.value=!0;try{await i({username:a.value,password:o.value},k())}catch(n){if(typeof n=="string"&&n.trim().length>0)p.value=n;else if(n&&typeof n=="object")try{p.value=JSON.stringify(n,null,2)}catch{p.value=String(n)}else p.value="Erreur lors de la connexion"}finally{t.value=!1}}};return(n,b)=>(_(),f("div",N,[T,e("div",D,[e("div",J,[O,m(e("input",{id:"login-username","onUpdate:modelValue":b[0]||(b[0]=g=>a.value=g),type:"email",autocomplete:"username",class:"form-input",placeholder:"vous@email.com"},null,512),[[v,a.value]])]),e("div",R,[H,m(e("input",{id:"login-password","onUpdate:modelValue":b[1]||(b[1]=g=>o.value=g),type:"password",autocomplete:"current-password",class:"form-input",placeholder:"Votre mot de passe"},null,512),[[v,o.value]])])]),p.value?(_(),f("div",G,[K,e("div",null,h(p.value),1)])):S("",!0),e("div",Q,[e("button",{type:"button",class:"flex-1 rounded-lg border border-slate-600 px-3 py-2 text-sm text-slate-200 hover:border-slate-500 hover:text-white transition-colors",disabled:t.value,onClick:$}," Annuler ",8,W),e("button",{type:"button",class:"flex-1 rounded-lg bg-sky-600 px-3 py-2 text-sm font-semibold text-white hover:bg-sky-500 disabled:opacity-60 disabled:cursor-not-allowed transition-colors",disabled:t.value||!a.value.trim()||!o.value.trim(),onClick:C},h(t.value?"Connexion...":"Valider"),9,X)])]))}});const Z=M(Y,[["__scopeId","data-v-16e295b0"]]),u=c=>(E("data-v-26bd6eb4"),c=c(),F(),c),ee={class:"rounded-2xl border border-slate-700 bg-slate-900/70 p-6 shadow-xl backdrop-blur-sm md:p-7"},te={class:"mb-6"},se=u(()=>e("h2",{class:"text-xl font-semibold text-slate-100"},"Inscription",-1)),le=u(()=>e("p",{class:"mt-2 text-sm text-slate-300"},"Crée ton compte pour démarrer.",-1)),oe={class:"mt-3 text-xs font-medium text-slate-400"},ae={class:"mt-2 h-1.5 w-full rounded-full bg-slate-800"},ne={key:0,class:"space-y-5"},ie={class:"flex flex-col gap-2"},re=u(()=>e("label",{for:"signin-email",class:"text-sm font-medium text-slate-200"},"Email*",-1)),de={class:"flex flex-col gap-2"},ue=u(()=>e("label",{for:"signin-password",class:"text-sm font-medium text-slate-200"},"Mot de passe*",-1)),ce={key:1,class:"space-y-5"},pe={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},me={class:"flex flex-col gap-2"},_e=u(()=>e("label",{for:"signin-first-name",class:"text-sm font-medium text-slate-200"},"Prénom",-1)),ve={class:"flex flex-col gap-2"},xe=u(()=>e("label",{for:"signin-last-name",class:"text-sm font-medium text-slate-200"},"Nom",-1)),fe={class:"flex flex-col gap-2"},be=u(()=>e("label",{for:"signin-photo",class:"text-sm font-medium text-slate-200"},"Photo de profil (URL)",-1)),he=["src"],ge={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ye={class:"flex flex-col gap-2"},we=u(()=>e("label",{for:"signin-pseudo",class:"text-sm font-medium text-slate-200"},"Pseudo",-1)),ke={class:"flex flex-col gap-2"},$e=u(()=>e("label",{for:"signin-handle",class:"text-sm font-medium text-slate-200"},"Handle* (@...)",-1)),Ce=u(()=>e("p",{class:"text-xs text-slate-400"},"Ce handle sera visible publiquement.",-1)),Se={class:"inline-flex items-center gap-2 text-sm text-slate-200"},Ve={key:2,class:"mt-4 rounded-lg border border-red-500/40 bg-red-500/10 px-3 py-2 text-xs text-red-200 whitespace-pre-wrap break-words"},Ue=u(()=>e("div",{class:"font-semibold mb-1"},"Inscription impossible",-1)),Pe={class:"mt-6 flex gap-3"},Ie=["disabled"],Ee=["disabled"],Fe=V({__name:"SignInForm",setup(c){const{createNewUser:d}=I(),i=x(""),a=x(!1),o=x(1),t=x({username:"",email:"",first_name:"",last_name:"",profile_picture_url:"",handle:"@",password:"",pseudonym:"",pseudonymized:!1});A(()=>[t.value.first_name,t.value.last_name],([r,s])=>{if(r||s){const l=r?r.toLowerCase().replace(/\s+/g,"_"):"",y=s?s.toLowerCase().replace(/\s+/g,"_"):"";l&&y?t.value.handle="@"+l+"_"+y:l?t.value.handle="@"+l:y?t.value.handle="@"+y:t.value.handle="@"}else t.value.handle="@"},{immediate:!0});const p=()=>{t.value={username:"",email:"",first_name:"",last_name:"",profile_picture_url:"",handle:"@",password:"",pseudonym:"",pseudonymized:!1},o.value=1,i.value=""},k=()=>{!t.value.email.trim()||!t.value.password.trim()||(i.value="",o.value=2)},$=()=>{o.value=1,i.value=""},C=L(()=>a.value?!0:o.value===1?!t.value.email.trim()||!t.value.password.trim():!t.value.email.trim()||!t.value.password.trim()||!t.value.handle.trim()),n=async()=>{if(o.value===1){k();return}await g()},b=()=>{if(o.value===1){p();return}$()},g=async()=>{if(!a.value){i.value="",a.value=!0;try{await d(t.value)}catch(r){if(typeof r=="string"&&r.trim().length>0)i.value=r;else if(r&&typeof r=="object")try{i.value=JSON.stringify(r,null,2)}catch{i.value=String(r)}else i.value=String(r??"Erreur lors de la création du compte")}finally{a.value=!1}}};return(r,s)=>(_(),f("div",ee,[e("div",te,[se,le,e("p",oe,"Étape "+h(o.value)+" / 2",1),e("div",ae,[e("div",{class:"h-full rounded-full bg-sky-500 transition-all duration-200",style:j({width:o.value===1?"50%":"100%"})},null,4)])]),o.value===1?(_(),f("div",ne,[e("div",ie,[re,m(e("input",{id:"signin-email","onUpdate:modelValue":s[0]||(s[0]=l=>t.value.email=l),type:"email",autocomplete:"email",placeholder:"vous@email.com",class:"form-input"},null,512),[[v,t.value.email]])]),e("div",de,[ue,m(e("input",{id:"signin-password","onUpdate:modelValue":s[1]||(s[1]=l=>t.value.password=l),type:"password",autocomplete:"new-password",placeholder:"Mot de passe",class:"form-input"},null,512),[[v,t.value.password]])])])):(_(),f("div",ce,[e("div",pe,[e("div",me,[_e,m(e("input",{id:"signin-first-name","onUpdate:modelValue":s[2]||(s[2]=l=>t.value.first_name=l),type:"text",autocomplete:"given-name",placeholder:"Prénom",class:"form-input"},null,512),[[v,t.value.first_name]])]),e("div",ve,[xe,m(e("input",{id:"signin-last-name","onUpdate:modelValue":s[3]||(s[3]=l=>t.value.last_name=l),type:"text",autocomplete:"family-name",placeholder:"Nom",class:"form-input"},null,512),[[v,t.value.last_name]])])]),e("div",fe,[be,m(e("input",{id:"signin-photo","onUpdate:modelValue":s[4]||(s[4]=l=>t.value.profile_picture_url=l),type:"url",autocomplete:"url",placeholder:"https://...",class:"form-input"},null,512),[[v,t.value.profile_picture_url]])]),t.value.profile_picture_url!==""?(_(),f("img",{key:0,class:"rounded-lg max-h-36 object-cover border border-slate-700 mt-1",src:t.value.profile_picture_url},null,8,he)):S("",!0),e("div",ge,[e("div",ye,[we,m(e("input",{id:"signin-pseudo","onUpdate:modelValue":s[5]||(s[5]=l=>t.value.pseudonym=l),type:"text",placeholder:"Votre pseudo",class:"form-input"},null,512),[[v,t.value.pseudonym]])]),e("div",ke,[$e,m(e("input",{id:"signin-handle","onUpdate:modelValue":s[6]||(s[6]=l=>t.value.handle=l),type:"text",placeholder:"@votre_handle",class:"form-input"},null,512),[[v,t.value.handle]]),Ce])]),e("label",Se,[m(e("input",{"onUpdate:modelValue":s[7]||(s[7]=l=>t.value.pseudonymized=l),type:"checkbox",class:"rounded border-slate-600 bg-slate-900 text-sky-500 focus:ring-sky-500"},null,512),[[q,t.value.pseudonymized]]),B(" Ne montrer que votre pseudo ")])])),i.value?(_(),f("div",Ve,[Ue,e("div",null,h(i.value),1)])):S("",!0),e("div",Pe,[e("button",{type:"button",class:"flex-1 rounded-lg border border-slate-600 px-3 py-2 text-sm text-slate-200 hover:border-slate-500 hover:text-white transition-colors",disabled:a.value,onClick:b},h(o.value===1?"Annuler":"Précédent"),9,Ie),e("button",{type:"button",class:"flex-1 rounded-lg bg-sky-600 px-3 py-2 text-sm font-semibold text-white hover:bg-sky-500 disabled:opacity-60 disabled:cursor-not-allowed transition-colors",disabled:C.value,onClick:n},h(o.value===1?"Continuer":a.value?"Création...":"Valider"),9,Ee)])]))}});const Me=M(Fe,[["__scopeId","data-v-26bd6eb4"]]),ze={class:"min-h-screen bg-slate-950 text-slate-100 p-4 md:p-8"},Ae={class:"mx-auto max-w-xl pt-4 md:pt-10"},Le=e("h1",{class:"text-3xl font-bold tracking-tight"},"Bienvenue",-1),je=e("p",{class:"mt-2 text-sm text-slate-400"}," Connecte-toi pour accéder à ton studio et reprendre ton travail. ",-1),qe={class:"mt-6 inline-flex rounded-xl border border-slate-700 bg-slate-900/70 p-1"},Be={class:"mt-4"},Te=V({__name:"LoginPage",setup(c){const d=x(!1);return(i,a)=>(_(),f("div",ze,[e("div",Ae,[Le,je,e("div",qe,[e("button",{type:"button",class:U(["px-4 py-2 text-sm rounded-lg transition-colors",d.value?"text-slate-400 hover:text-slate-200":"bg-slate-700 text-slate-100"]),onClick:a[0]||(a[0]=o=>d.value=!1)}," Connexion ",2),e("button",{type:"button",class:U(["px-4 py-2 text-sm rounded-lg transition-colors",d.value?"bg-slate-700 text-slate-100":"text-slate-400 hover:text-slate-200"]),onClick:a[1]||(a[1]=o=>d.value=!0)}," Inscription ",2)]),e("div",Be,[d.value?(_(),P(Me,{key:1})):(_(),P(Z,{key:0}))])])]))}});export{Te as default};
