import{d as y,r as c,c as m,o as $,q as A,e as r,a as l,g as n,h as w,H as I,t as i,b as N,i as S,n as H,F as U,m as j}from"./index-675deefb.js";import{u as q}from"./useResourceRelations-6471b35f.js";const D=u=>{if(!u)return[];const t=u.replace("/?/g","?.").split(".");let o=0;const a=[];for(;o<t.length-1;){let d=0,s=[];if(t[o].length>=270)a.push(t[o].replace("/?./g","?")),o++;else{for(;o<t.length&&d+t[o].length<270;)s.push(t[o]),d+=t[o].length,o++;a.push(s.join(". ").replace("/?./g","?"))}}return a},x={splitTextForPanel:D},M={class:"flex flex-col border p-1.5 overflow-auto"},V={key:1,class:"animate-pulse w-2/3 bg-gradient-to-r from-slate-600 h-8 mb-1.5"},z=["src"],E={key:1,class:"overflow-auto h-full overflow-scroll bg-red-100 p-1 pt-8 border"},G={class:"bg-red-100 text-center text-sm my-auto"},J={key:2,class:"overflow-auto h-full overflow-scroll bg-blue-100 p-1 pt-8 border"},K={class:"bg-blue-100 text-center text-sm my-auto"},O={class:"absolute right-2 top-2 bg-gray-400 rounded-xl p-1 text-xs opacity-70"},Q={class:""},W={class:"mb-2 font-bold text-sm"},X={class:"text-2xs mb-auto"},Y={class:"flex mt-2"},Z={class:"ml-auto text-2xs underline"},ee=y({__name:"FeedCard",props:{interaction:{}},setup(u){const t=u,o=e=>e?e.toLocaleString("fr-FR",{day:"numeric",month:"short",year:"2-digit"}):"",a=e=>e==="outp"?"Production personnelle":"Bibliographie",d=e=>{switch(e){case"pblm":return"ProblÃ©matique";case"book":return"Livre";case"atcl":return"Article";case"ratc":return"Article de recherche"}return e},s=c(0);c(null);const g=c(null),k=()=>{s.value=(s.value+1)%v.value},T=m(()=>`${s.value+1}/${v.value}`),v=m(()=>h.value.length+_.value.length+1),_=m(()=>x.splitTextForPanel(t.interaction.resource.content)),h=m(()=>x.splitTextForPanel(t.interaction.context_comment)),F=e=>e?e.length>200?e.slice(0,150)+"...":e:"",f=c([]),{getResourceRelationsForResource:B}=q(),C=async()=>{t.interaction.id&&(f.value=await B(t.interaction.resource.id))},{getUserById:L}=H(),b=c(!1),R=async()=>{try{g.value=await L(t.interaction.user_id)}catch(e){console.log(e)}b.value=!0},p=c(null);return $(async()=>{await C(),await R();const e=p.value.offsetHeight;p.value.style.height=`${e}px`}),(e,oe)=>{const P=A("router-link");return r(),l("div",M,[n("div",null,[b.value?(r(),w(I,{key:0,class:"flex mb-1.5 h-8",user:g.value,secondText:o(e.interaction.date),firstBottomText:a(e.interaction.interaction_type),secondBottomText:d(e.interaction.resource.resource_type)},null,8,["user","secondText","firstBottomText","secondBottomText"])):(r(),l("div",V))]),n("div",{onClick:k,class:"overflow-auto relative w-full md:h-3/5 min-h-60 mb-2 bg-gray-700",ref_key:"parentCard",ref:p},[s.value==0?(r(),l("img",{key:0,class:"overflow-auto object-contain w-full h-full mt-auto mx-auto",src:e.interaction.resource.image_url},null,8,z)):s.value>0&&s.value<=h.value.length?(r(),l("div",E,[n("div",G,i(h.value[s.value-1]),1)])):(r(),l("div",J,[n("div",K,i(_.value[s.value-h.value.length-1]),1)])),n("div",O,i(T.value),1)],512),N(P,{class:"",to:"/thought_outputs/"+e.interaction.resource.id},{default:S(()=>[n("div",Q,[n("div",W,i(e.interaction.resource.title),1),n("div",X,i(F(e.interaction.resource.subtitle)),1),n("div",Y,[n("div",Z,i(f.value.length)+" inputs",1)])])]),_:1},8,["to"])])}}}),te={class:"flex flex-col"},re=y({__name:"FeedList",props:{interactionsList:{}},setup(u){return(t,o)=>(r(),l("div",te,[(r(!0),l(U,null,j(t.interactionsList,(a,d)=>(r(),w(ee,{class:"md:mb-2 flex-grow md:rounded max-h-screen border-b-1 border-black",interaction:a},null,8,["interaction"]))),256))]))}});export{re as _};
