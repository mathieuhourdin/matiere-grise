import{u as v}from"./useResourceRelations-22334af8.js";import{d as x,j as m,b as s,c as a,l as o,t as i,p as b,r as _,o as k,e as I,z as R,F as w,g as C,h as L,k as f,K as z}from"./index-67386673.js";const $=["title"],A={class:"truncate max-w-[200px]"},B=x({__name:"Chip",props:{text:{},tooltip:{default:""},maxLength:{default:30}},setup(l){const t=l,u=m(()=>t.text.length<=t.maxLength?t.text:t.text.substring(0,t.maxLength)+"..."),c=m(()=>t.tooltip||t.text);return(n,p)=>(s(),a("div",{class:b(["inline-flex items-center px-2 py-1 rounded-md text-xs font-medium transition-colors duration-200","bg-slate-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200","border border-slate-300 dark:border-gray-600","hover:bg-slate-300 dark:hover:bg-gray-600"]),title:c.value},[o("span",A,i(u.value),1)],8,$))}}),D={key:0},F={class:"flex justify-between items-center"},j={class:"text-lg font-bold mb-2"},N={key:0,class:"flex flex-wrap gap-2 mb-2"},V={class:"text-sm dark:text-gray-300 text-gray-700 mb-2"},E={class:"text-sm dark:text-gray-300 text-gray-500 whitespace-pre-line"},J=x({__name:"JournalItem",props:{resourceItem:{}},setup(l){const t=l,{getAllRelationsForResource:u}=v(),c=_([]),n=_(!1),p=async()=>{n.value=!0;try{const e=await z.post("/lens",{current_trace_id:t.resourceItem.resource.id});console.log("Lens created:",e.data)}catch(e){console.error("Error creating lens:",e)}finally{n.value=!1}},g=m(()=>c.value.filter(e=>e.origin_resource)),h=e=>e.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),y=e=>{if(!e.origin_resource)return"";const r=[];return r.push(e.origin_resource.title),e.origin_resource.subtitle&&r.push(e.origin_resource.subtitle),e.relation_comment&&r.push(`Commentaire: ${e.relation_comment}`),e.origin_resource.content&&r.push(e.origin_resource.content),r.join(`
`)};return k(async()=>{const e=await u(t.resourceItem.resource.id);c.value=e.filter(r=>r.relation_type==="elmt")}),(e,r)=>(s(),a("div",null,[e.resourceItem.resource?(s(),a("div",D,[o("div",F,[o("div",j,i(h(new Date(e.resourceItem.date)))+" - "+i(e.resourceItem.resource.title),1),o("div",null,[I(R,{type:"valid",size:"sm",text:n.value?"Analyse en cours...":"Analyser",disabled:n.value,onClick:p},null,8,["text","disabled"])])]),g.value.length>0?(s(),a("div",N,[(s(!0),a(w,null,C(g.value,d=>(s(),L(B,{key:d.id,text:d.origin_resource.title,tooltip:y(d)},null,8,["text","tooltip"]))),128))])):f("",!0),o("div",V,i(e.resourceItem.resource.subtitle),1),o("div",E,i(e.resourceItem.resource.content),1)])):f("",!0)]))}});export{J as _};
