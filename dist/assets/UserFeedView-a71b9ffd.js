import{_ as I}from"./FeedList.vue_vue_type_script_setup_true_lang-9cc81d7c.js";import{d as b,n as k,y as $,h as w,b as V,e as x,B,f as m,a as t,q as g,t as n,c as _,w as h,J as C,m as f,i as u,o,K as N,u as q}from"./index-c12685c0.js";import{_ as i,a as E}from"./ActionButton.vue_vue_type_script_setup_true_lang-9e80b0f1.js";import{_ as P}from"./CheckboxInput.vue_vue_type_script_setup_true_lang-95e977e8.js";import{_ as z}from"./TextAreaInput.vue_vue_type_script_setup_true_lang-db8eaa9f.js";import"./useResourceRelations-65809224.js";import"./useResource-512f2130.js";const R={class:"text-center p-4 bg-slate-200"},A={key:0,class:"relative"},D=["src"],F={key:0,class:"text-2xl bold"},H={key:1,class:"text-2xl bold"},J={class:"mt-4"},K={key:1},M={class:"grid grid-cols-2 gap-y-1 gap-x-2"},S={class:"col-span-1 flex flex-col"},W={class:"col-span-2"},j={class:"mt-2 flex flex-row-reverse"},G=b({__name:"UserInfos",props:{user:{}},setup(y){const r=y,{user:c,debouncedUpdateUser:U}=k(),p=$(),v=w(()=>!r.user.is_platform_user||r.user.id===c.value.id),d=V(!1),s=V(null);return x(()=>{s.value=r.user,d.value=p.query.editingUser}),B(s,a=>{v.value&&U(a.id,a)},{deep:!0}),(a,e)=>(o(),m("div",R,[d.value?(o(),m("div",K,[t("div",M,[u(i,{class:"col-span-2",modelValue:s.value.profile_picture_url,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.profile_picture_url=l),label:"Photo de profil"},null,8,["modelValue"]),u(i,{class:"col-span-1",modelValue:s.value.first_name,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.first_name=l),label:"PrÃ©nom"},null,8,["modelValue"]),u(i,{class:"col-span-1",modelValue:s.value.last_name,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.last_name=l),label:"Nom"},null,8,["modelValue"]),u(i,{class:"col-span-1",modelValue:s.value.pseudonym,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.pseudonym=l),label:"Pseudo"},null,8,["modelValue"]),t("div",S,[u(P,{class:"item-center mr-auto my-auto",modelValue:s.value.pseudonymized,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.pseudonymized=l),label:"Ne montrer que votre pseudo"},null,8,["modelValue"])]),s.value.is_platform_user?(o(),_(i,{key:0,class:"col-span-1",modelValue:s.value.handle,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.handle=l),label:"Handle"},null,8,["modelValue"])):f("",!0),s.value.is_platform_user?(o(),_(i,{key:1,class:"col-span-1",modelValue:s.value.email,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.email=l),label:"Email"},null,8,["modelValue"])):f("",!0),t("div",W,[u(z,{modelValue:s.value.biography,"onUpdate:modelValue":e[8]||(e[8]=l=>s.value.biography=l),label:"Bio"},null,8,["modelValue"])])]),t("div",j,[u(E,{onClick:e[9]||(e[9]=l=>d.value=!1),text:"Valider",type:"valid"})])])):(o(),m("div",A,[t("img",{src:a.user.profile_picture_url,class:"mx-auto m-4 w-1/6"},null,8,D),a.user.id===g(c).id?(o(),m("div",F,n(a.user.first_name)+" "+n(a.user.last_name)+" "+n(a.user.pseudonym),1)):(o(),m("div",H,n(a.user.display_name),1)),t("div",null,n(a.user.handle),1),t("div",null,n(a.user.email),1),t("div",J,n(a.user.biography),1),v.value?(o(),_(C,{key:2,class:"right-4 absolute",onClick:e[0]||(e[0]=l=>d.value=!0)},{default:h(()=>[u(g(N),{class:"m-1"})]),_:1})):f("",!0)]))]))}}),L={class:"mt-8 md:mx-6"},se=b({__name:"UserFeedView",props:{pageUserId:{}},setup(y){const r=y,{getUserById:c,user:U}=k(),p=V(null),{getUserReadAndWriteInteractions:v,getInteractions:d}=q(),s=V([]),a=w(()=>s.value.map(e=>({resource:e.resource,date:e.interaction_date,user_id:e.interaction_user_id,context_comment:e.interaction_comment,progress:e.interaction_progress,...e})).sort((e,l)=>l.resource.updated_at-e.resource.updated_at));return x(async()=>{p.value=await c(r.pageUserId),s.value=await v(r.pageUserId);const e=await d({interaction_type:"rvew",interaction_user_id:r.pageUserId});s.value=s.value.concat(e)}),(e,l)=>(o(),m("div",null,[t("div",L,[p.value?(o(),_(G,{key:0,class:"mx-auto border my-8",user:p.value},null,8,["user"])):f("",!0),u(I,{"interactions-list":a.value},null,8,["interactions-list"])])]))}});export{se as default};
