import{u as $,a as w}from"./useProblem-975a9d24.js";import{d as g,r as _,o as k,s as A,b as l,c as a,f,h as F,e as r,t as d,j as x,m as I,a as B,k as L,F as C,l as P,v as N,q as V,x as D,g as M}from"./index-0eedff49.js";import{u as U}from"./useResource-b08a6b5c.js";const j={class:"border shadow-xl rounded m-2 p-4 h-72 w-60"},q=["src"],S={class:""},T={class:"mb-2"},E={key:0,class:"text-2xs italic",style:{"margin-top":"-8px"}},W={class:"text-2xs mb-auto"},z={class:"flex mt-2"},G={class:"text-2xs italic mt-auto"},H={class:"ml-auto text-2xs underline"},y=g({__name:"ProblemCard",props:{problem:{}},setup(b){const c=b,n=s=>s?s.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",m=_(null),u=_(null),p=s=>s.length>200?s.slice(0,150)+"...":s,{getAuthorInteractionForResource:i}=U(),t=_([]),{getResourceRelationsForResource:o}=$(),e=async()=>{c.problem.id&&(t.value=await o(c.problem.id))},{getUserById:h}=I(),v=async()=>{m.value=await i(c.problem.id),m.value&&(u.value=await h(m.value.interaction_user_id))};return k(async()=>{await e(),await v()}),(s,Z)=>{const R=A("router-link");return l(),a("div",j,[f(R,{to:"/thought_outputs/"+s.problem.id},{default:F(()=>[r("img",{class:"h-2/5 mx-auto mb-4",src:s.problem.image_url},null,8,q),r("div",S,[r("div",T,d(s.problem.title),1),u.value?(l(),a("div",E,d(u.value.first_name)+" "+d(u.value.last_name),1)):x("",!0),r("div",W,d(p(s.problem.subtitle)),1),r("div",z,[r("div",G,d(n(s.problem.created_at)),1),r("div",H,d(t.value.length)+" inputs",1)])])]),_:1},8,["to"])])}}}),J={class:"flex"},K=r("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),O={key:0,class:"flex overflow-x-scroll"},Q={key:1},X=g({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(b){const c=b,{newProblem:n,createProblem:m}=w(),u=B(),{isMobile:p}=N(),i=_(0),t=async()=>{const e=n();e.resource.category_id=c.category.id;const h=await m(e);u.push({path:"/thought_outputs/"+h.resource.id,query:{editing:"true"}})},o=e=>e=="default"?"Autres":e;return(e,h)=>(l(),a("div",null,[r("div",J,[r("div",null,d(o(e.category.display_name)),1),r("div",{onClick:t,class:"ml-auto text-sm mr-2 underline"}," Ajouter ")]),K,L(p)?(l(),a("div",Q,[f(y,{problem:e.problemsList[i.value]},null,8,["problem"])])):(l(),a("div",O,[(l(!0),a(C,null,P(e.problemsList,(v,s)=>(l(),a("div",{class:"mb-4",key:s},[f(y,{problem:v},null,8,["problem"])]))),128))]))]))}}),Y={key:0,class:"m-4"},oe=g({__name:"ProblemsView",setup(b){const{getProblems:c}=w(),n=_(null),{categories:m}=D(),u=V(()=>m.value.map(t=>(t.problems=p(t),t.problems_count=t.problems?t.problems.length:0,t))),p=i=>{var t,o;return i.display_name=="default"?(t=n.value)==null?void 0:t.filter(e=>e.category_id==null):(o=n.value)==null?void 0:o.filter(e=>e.category_id==i.id)};return k(async()=>n.value=await c()),(i,t)=>(l(),a("div",null,[n.value?(l(),a("div",Y,[(l(!0),a(C,null,P(u.value.sort((o,e)=>e.problems_count-o.problems_count),o=>(l(),M(X,{class:"mt-4",category:o,key:o.id,"problems-list":o.problems},null,8,["category","problems-list"]))),128))])):x("",!0)]))}});export{oe as default};
