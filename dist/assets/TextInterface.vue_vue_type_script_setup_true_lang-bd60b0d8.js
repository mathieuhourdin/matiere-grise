import{e as I,g as P,r as s,h as T,m,l as z,o as n,c as r,n as W,k as $,F as x,p as y,q as D,b as L,t as N}from"./index-7ab16c51.js";const O=["onClick"],R={key:0,style:{width:"5px"}},S={key:1,style:{height:"25px"}},V={key:2},K=I({__name:"TextInterface",props:{fullText:{}},emits:["change"],setup(k,{emit:C}){const v=k,_=P(()=>{console.log("Compute lines");let e=[{id:0,text:[]}].concat(o.value.filter(l=>l.char==`
`));console.log("Compute ids.length : ",e.length);for(let l=0;l<e.length-1;l++)console.log("Compute line : ",l),e[l].text=o.value.filter(t=>t.id>=e[l].id&&t.id<e[l+1].id);return e[e.length-1].text=o.value.filter(l=>l.id>=e[e.length-1].id),e}),o=s([]),u=e=>{console.log("selectCursorPosition letter : ",e),a.value={id:e.id,char:e.char}},a=s(null),h=e=>{o.value.filter(l=>l.id>=a.value.id+1).forEach(l=>l.id+=1),o.value.splice(a.value.id+1,0,{id:a.value.id+1,char:e,line:0}),a.value.id+=1},b=e=>{if(console.log("Writes : ",e.key),a.value===null)return;const l=e.key;if(l.length==1)h(l);else if(l=="Backspace")o.value.splice(a.value.id,1),o.value.filter(t=>t.id>a.value.id).forEach(t=>t.id-=1),a.value.id-=1;else if(l=="Enter")h(`
`);else if(l=="ArrowRight"){let t=a.value.id;t<o.value.length-1&&u(o.value[t+1])}else if(l=="ArrowLeft"){let t=a.value.id;t>0&&u(o.value[t-1])}},c=s(!1),w=()=>{c.value=!1,document.getElementById("board").focus()},d=s({position:"absolute","z-index":90,top:0,left:0,height:"100px",width:"150px"}),B=e=>{e.preventDefault(),d.value.top=`${e.layerY}px`,d.value.left=`${e.layerX}px`,c.value=!0,console.log("event : ",e),console.log("Have a new right click")},f=e=>{if(console.log("textArrayFromString textString: ",e),o.value=[],e===void 0||e==""){o.value=[{id:0,char:`
`}],u({id:0,char:`
`});return}for(var l=0;l<e.length;l++)o.value.push({id:l,char:e[l]})},E=e=>e.reduce((l,t)=>l+t.char,""),p=s(!1);return T(()=>{f(v.fullText),p.value=!0}),m(o,e=>{console.log("Watch triggered : ",e),p.value&&C("change",E(e))},{deep:!0}),m(z(v).fullText,e=>{f(e)}),(e,l)=>(n(),r("div",{autofocus:"",id:"board",class:"border-2 mx-auto relative p-4",tabindex:"0",onKeydown:b,onClick:w},[c.value?(n(),r("div",{key:0,class:"bg-white border-4",style:W(d.value)},null,4)):$("",!0),(n(!0),r(x,null,y(_.value,(t,A)=>(n(),r("div",{key:A,class:"flex flex-wrap w-full"},[(n(!0),r(x,null,y(t.text,(i,F)=>{var g;return n(),r("div",{key:F,class:D(["border-blue-400",{"border-r-2":i.id==((g=a.value)==null?void 0:g.id)}]),onClick:q=>u(i),onContextmenu:B},[i.char==" "?(n(),r("div",R)):i.char==`
`?(n(),r("div",S)):(n(),r("div",V,[L("div",null,N(i.char),1)]))],42,O)}),128))]))),128))],32))}});export{K as _};
