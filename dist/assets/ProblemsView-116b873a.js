import{u as L,a as C}from"./useProblem-f5f616b6.js";import{d as g,r as h,o as x,s as B,b as e,c as r,f as y,_ as I,e as l,t as _,j as P,h as M,m as N,a as V,F as v,l as f,g as w,q as j,k as D,v as U,x as q}from"./index-30a8545d.js";import{u as S}from"./useResource-aa940140.js";const T={class:"border p-1.5"},E={key:0,class:"flex mb-1.5"},W={class:"text-xs italic my-auto ml-2"},z=["src"],G={key:1,class:"max-h-40 overflow-scroll bg-white p-1 rounded border"},H={class:"bg-white"},J={class:""},K={class:"mb-2"},O={class:"text-2xs mb-auto"},Q={class:"flex mt-2"},X={class:"text-2xs italic mt-auto"},Y={class:"ml-auto text-2xs underline"},$=g({__name:"ProblemCard",props:{problem:{}},setup(p){const i=p,c=n=>n?n.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",m=h(0),d=h(null),u=h(null),b=n=>n.length>200?n.slice(0,150)+"...":n,{getAuthorInteractionForResource:o}=S(),s=h([]),{getResourceRelationsForResource:t}=L(),a=async()=>{i.problem.id&&(s.value=await t(i.problem.id))},{getUserById:R}=N(),F=async()=>{d.value=await o(i.problem.id),d.value&&(u.value=await R(d.value.interaction_user_id))};return x(async()=>{await a(),await F()}),(n,k)=>{const A=B("router-link");return e(),r("div",T,[u.value?(e(),r("div",E,[y(I,{user:u.value},null,8,["user"]),l("div",W,_(u.value.first_name)+" "+_(u.value.last_name),1)])):P("",!0),l("div",{onClick:k[0]||(k[0]=ae=>m.value=1),class:"h-3/5 mb-2 bg-gray-700"},[m.value==0?(e(),r("img",{key:0,class:"object-contain w-full h-full mt-auto mx-auto",src:n.problem.image_url},null,8,z)):(e(),r("div",G,[l("div",H,_(n.problem.content),1)]))]),y(A,{to:"/thought_outputs/"+n.problem.id},{default:M(()=>[l("div",J,[l("div",K,_(n.problem.title),1),l("div",O,_(b(n.problem.subtitle)),1),l("div",Q,[l("div",X,_(c(n.problem.created_at)),1),l("div",Y,_(s.value.length)+" inputs",1)])])]),_:1},8,["to"])])}}}),Z={class:"flex"},ee=l("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),se={class:"flex overflow-scroll"},te=g({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(p){const i=p,{newProblem:c,createProblem:m}=C(),d=V(),u=async()=>{const o=c();o.resource.category_id=i.category.id;const s=await m(o);d.push({path:"/thought_outputs/"+s.resource.id,query:{editing:"true"}})},b=o=>o=="default"?"Autres":o;return(o,s)=>(e(),r("div",null,[l("div",Z,[l("div",null,_(b(o.category.display_name)),1),l("div",{onClick:u,class:"ml-auto text-sm mr-2 underline"}," Ajouter ")]),ee,l("div",se,[(e(!0),r(v,null,f(o.problemsList,(t,a)=>(e(),r("div",{class:"mb-4",key:a},[y($,{class:"w-80 h-96 mx-3 shadow-xl rounded",problem:t},null,8,["problem"])]))),128))])]))}}),oe=g({__name:"MobileProblemsFeed",props:{problemsList:{}},setup(p){return(i,c)=>(e(),r("div",null,[(e(!0),r(v,null,f(i.problemsList,(m,d)=>(e(),w($,{class:"border-b-1 border-black",problem:m},null,8,["problem"]))),256))]))}}),re={key:0,class:"md:m-4"},le={key:0},ne={key:1},me=g({__name:"ProblemsView",setup(p){const{getProblems:i}=C(),c=h(null),{categories:m}=U(),{isMobile:d}=q(),u=j(()=>m.value.map(s=>(s.problems=b(s),s.problems_count=s.problems?s.problems.length:0,s))),b=o=>{var s,t;return o.display_name=="default"?(s=c.value)==null?void 0:s.filter(a=>a.category_id==null):(t=c.value)==null?void 0:t.filter(a=>a.category_id==o.id)};return x(async()=>c.value=await i()),(o,s)=>(e(),r("div",null,[c.value?(e(),r("div",re,[D(d)?(e(),r("div",ne,[(e(!0),r(v,null,f(u.value.sort((t,a)=>a.problems_count-t.problems_count),t=>(e(),w(oe,{"problems-list":t.problems},null,8,["problems-list"]))),256))])):(e(),r("div",le,[(e(!0),r(v,null,f(u.value.sort((t,a)=>a.problems_count-t.problems_count),t=>(e(),w(te,{class:"mt-4",category:t,key:t.id,"problems-list":t.problems},null,8,["category","problems-list"]))),128))]))])):P("",!0)]))}});export{me as default};
