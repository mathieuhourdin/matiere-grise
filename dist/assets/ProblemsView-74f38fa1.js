import{A as T,d as v,r as f,j as y,s as $,o as u,c,h as w,w as B,f as t,t as m,a as P,e as D,k as C,F as k,m as x,n as F,p as I,i as N}from"./index-80c66211.js";import{a as U,u as L}from"./useThoughtOutput-bffaeb6b.js";const{createThoughtOutput:R}=U(),V=()=>({title:"",description:"",content:"",publishing_state:"drft",image_url:"",output_type:"pblm",progress:0,potential_improvements:"",maturing_state:""}),j=r=>(r.created_at&&(r.created_at=new Date(r.created_at.split(".")[0])),r),q=async()=>(await T.get("/problems")).data.map(a=>j(a));function A(){return{newProblem:V,getProblems:q,createProblem:R}}const O={class:"border shadow-xl rounded m-2 p-4 h-72 w-60"},S={class:"max-h-full"},W=["src"],E={class:"h-full"},M={class:"mb-2"},z={key:0,class:"text-2xs italic",style:{"margin-top":"-8px"}},G={class:"text-2xs mb-auto"},H={class:"flex mt-2"},J={class:"text-2xs italic mt-auto"},K={class:"ml-auto text-2xs underline"},Q=v({__name:"ProblemCard",props:{problem:{}},setup(r){const a=r,p=e=>e?e.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",i=f(null),_=e=>e.length>200?e.slice(0,150)+"...":e,l=f([]),{getThoughtInputUsagesForThoughtOutput:h}=L(),o=async()=>{a.problem.id&&(l.value=await h(a.problem.id))},{getUserById:d}=D(),b=async()=>{a.problem.author_id&&(i.value=await d(a.problem.author_id))};return y(async()=>{await o(),await b()}),(e,s)=>{const n=$("router-link");return u(),c("div",O,[w(n,{to:"/thought_outputs/"+e.problem.id},{default:B(()=>[t("div",S,[t("img",{class:"h-28 mx-auto mb-4",src:e.problem.image_url},null,8,W),t("div",E,[t("div",M,m(e.problem.title),1),i.value?(u(),c("div",z,m(i.value.first_name)+" "+m(i.value.last_name),1)):P("",!0),t("div",G,m(_(e.problem.description)),1),t("div",H,[t("div",J,m(p(e.problem.created_at)),1),t("div",K,m(l.value.length)+" inputs",1)])])])]),_:1},8,["to"])])}}}),X={class:"flex"},Y=t("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),Z={class:"flex overflow-scroll"},ee=v({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(r){const a=r,{newProblem:p,createProblem:i}=A(),_=C(),l=async()=>{const o=p();o.category_id=a.category.id;const d=await i(o);_.push({path:"/thought_outputs/"+d.id,query:{editing:"true"}})},h=o=>o=="default"?"Autres":o;return(o,d)=>(u(),c("div",null,[t("div",X,[t("div",null,m(h(o.category.display_name)),1),t("div",{onClick:l,class:"ml-auto text-sm mr-2 underline"},"Ajouter")]),Y,t("div",Z,[(u(!0),c(k,null,x(o.problemsList,(b,e)=>(u(),c("div",{class:"mb-4",key:e},[w(Q,{problem:b},null,8,["problem"])]))),128))])]))}}),te={key:0,class:"m-4"},re=v({__name:"ProblemsView",setup(r){const a=C(),{getProblems:p,newProblem:i,createProblem:_}=A(),l=f(null),{categories:h}=I(),o=async()=>{const e=i(),s=await _(e);a.push({path:"/thought_outputs/"+s.id,query:{editing:"true"}})},d=F(()=>h.value.map(s=>(s.problems=b(s),s.problems_count=s.problems?s.problems.length:0,s))),b=e=>{var s,n;return e.display_name=="default"?(s=l.value)==null?void 0:s.filter(g=>g.category_id==null):(n=l.value)==null?void 0:n.filter(g=>g.category_id==e.id)};return y(async()=>l.value=await p()),(e,s)=>(u(),c("div",null,[l.value?(u(),c("div",te,[t("div",{class:"underline italic",onClick:o}," Ajouter une problÃ©matique "),(u(!0),c(k,null,x(d.value.sort((n,g)=>g.problems_count-n.problems_count),n=>(u(),N(ee,{class:"mt-4",category:n,key:n.id,"problems-list":n.problems},null,8,["category","problems-list"]))),128))])):P("",!0)]))}});export{re as default};
