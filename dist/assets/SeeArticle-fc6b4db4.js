import{o as s,c as m,f as a,d as V,r,l as w,t as C,u as R,i as _,h as i,_ as $,e as S,m as E,n as H,F as Z,p as ee,q as M,s as te,v as oe,w as T,x as N,a as q,y as se,z as le,A as z}from"./index-fd9b9d6c.js";import{a as G,b as ue,_ as ae}from"./ArticleForm.vue_vue_type_script_setup_true_lang-d7b6e2a4.js";import{_ as J,a as ne}from"./ThoughtInputsList.vue_vue_type_script_setup_true_lang-18469926.js";import{u as re}from"./useThoughtInputs-9af091db.js";import{u as K,a as ie}from"./useThoughtOutput-8d144f8e.js";import{_ as de,u as ce}from"./TextInterface.vue_vue_type_script_setup_true_lang-f327c4bf.js";import{_ as B}from"./TextInput.vue_vue_type_script_setup_true_lang-b06926d0.js";function pe(f,d){return s(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}const me={key:1},ve={class:"flex flex-row-reverse"},he=V({__name:"CreateThoughtInputUsageForm",props:{thoughtOutput:{}},emits:["close","refresh"],setup(f,{emit:d}){const v=f,{user:h}=S(),n=r([]),l=r(null),o=r(""),{createThoughtInputUsage:b}=K(),c=async()=>{console.log("create");const y={thought_output_id:v.thoughtOutput.id,thought_input_id:l.value.id,usage_reason:o.value};await b(y),d("refresh"),d("close")},{getUserThoughtInputs:x}=re(),U=y=>{l.value=y};return w(async()=>n.value=await x(h.value.id)),(y,g)=>(s(),m("div",null,[a("div",null,C(R(h).first_name),1),l.value?(s(),m("div",me,[i(G,{label:"Pourquoi ajouter cet élément ?",modelValue:o.value,"onUpdate:modelValue":g[1]||(g[1]=e=>o.value=e)},null,8,["modelValue"]),a("div",ve,[i($,{type:"valid",onClick:c,text:"Ajouter"}),i($,{type:"abort",onClick:g[2]||(g[2]=e=>d("close")),text:"Ajouter"})])])):(s(),_(J,{key:0,"thought-inputs":n.value,center:"",onSelect:g[0]||(g[0]=e=>U(e))},null,8,["thought-inputs"]))]))}}),ge={class:"mx-auto flex flex-wrap max-w-full"},_e=V({__name:"ToggleButtonGroup",props:{choices:{},default:{}},setup(f){const d=f,v=r(null),h=E(),n=H(),l=o=>{v.value=o;const b=n.query,c=n.path;h.push({path:c,query:{...b,tab:o}}),console.log(`route : ${JSON.stringify(n)}`)};return w(()=>l(d.default)),(o,b)=>(s(),m("div",ge,[(s(!0),m(Z,null,ee(o.choices,c=>(s(),_($,{key:c.value,class:"w-24 mx-auto my-1 md:mx-1",text:c.text,onClick:x=>l(c.value),type:c.value==v.value?"valid":"abort"},null,8,["text","onClick","type"]))),128))]))}}),fe={class:"flex"},be={class:"flex"},ye=V({__name:"ProblemForm",props:{problem:{}},emits:["change"],setup(f,{emit:d}){const v=f,h=(n,l)=>{let o={...v.problem};o[n]=l,d("change",o)};return(n,l)=>(s(),m("div",null,[i(B,{label:"Titre",modelValue:n.problem.title,"onUpdate:modelValue":l[0]||(l[0]=o=>h("title",o))},null,8,["modelValue"]),i(B,{class:"h-6",label:"Description",modelValue:n.problem.description,"onUpdate:modelValue":l[1]||(l[1]=o=>h("description",o))},null,8,["modelValue"]),a("div",fe,[i(ue,{class:"mr-auto h-6",label:"Progression",modelValue:n.problem.progress,"onUpdate:modelValue":l[2]||(l[2]=o=>h("progress",o))},null,8,["modelValue"])]),a("div",be,[i(B,{class:"h-6",label:"Lien image",modelValue:n.problem.image_url,"onUpdate:modelValue":l[3]||(l[3]=o=>h("image_url",o))},null,8,["modelValue"])])]))}}),xe={key:0,class:"px-8 mx-auto"},ke={key:0},Ce={class:"my-8"},$e=["src"],Te={class:"text-3xl my-3 font-mplus md:text-center text-left"},we={class:"md:text-center text-left"},Ve={class:"md:text-center text-left"},Ue={class:"md:flex my-8"},Oe=["href"],Ie={key:1},Ae={class:"flex flex-row-reverse"},qe={key:1,class:"p-2 border rounded bg-neutral-100"},Be=a("hr",{class:"border-top border-zinc-400 my-4"},null,-1),je={key:2},Fe={key:3},Se=V({__name:"SeeArticle",props:{id:{}},setup(f){const d=f,v=H(),h=r([{text:"Contenu",value:"ctnt"},{text:"Biblio",value:"bbli"}]),n=r(v.query.tab??"ctnt"),l=r(null);M(()=>v.query.tab,u=>{console.log("new route query",u),l.value=u});const{getThoughtInputUsagesForThoughtOutput:o}=K(),b=r([]),c=r(!1),x=async()=>{const u=await o(z(d).id.value);b.value=u.map(t=>({...t.thought_input,usage_reason:t.usage_reason}))};w(()=>x());const{getThoughtOutput:U,updateThoughtOutput:y}=ie(),g=r(null),e=r(null),Q=E();M(()=>v.query.editing,u=>{console.log("Editing : ",u),O.value=u==="false"?!1:!!u});const O=r(!1),j=u=>{Q.push({query:{editing:u}})},W=()=>{e.value.publishing_state="pbsh",y(e.value.id,e.value)},I=(u,t)=>{e.value=t,clearTimeout(g.value),g.value=setTimeout(async()=>{try{await y(u,e.value)}catch(A){console.log("An error : ",A)}},1e3)},F=u=>{u!=`
`&&I(z(d).id.value,{...e.value,content:u})},{user:P,getUserById:X}=S(),D=te(()=>P.value?e.value.author_id==P.value.id:!1),k=r(null),{getCommentsForThoughtOutput:Y}=ce(),L=r([]);return w(async()=>{e.value=await U(d.id),L.value=await Y(d.id),k.value=await X(e.value.author_id);const u=v.query.editing;O.value=u==="false"?!1:!!u}),(u,t)=>{const A=oe("router-link");return e.value?(s(),m("div",xe,[O.value?(s(),m("div",Ie,[e.value.output_type=="atcl"?(s(),_(ae,{key:0,article:e.value,onChange:t[1]||(t[1]=p=>I(e.value.id,p))},null,8,["article"])):(s(),_(ye,{key:1,problem:e.value,onChange:t[2]||(t[2]=p=>I(e.value.id,p))},null,8,["problem"])),a("div",Ae,[i($,{class:"mx-4",onClick:t[3]||(t[3]=p=>j(!1)),type:"valid",text:"Preview"},{default:T(()=>[N("Ok")]),_:1}),e.value.publishing_state=="drft"?(s(),_($,{key:0,onClick:W,type:"valid",text:"Publier"})):(s(),m("div",qe,"Publié"))])])):(s(),m("div",ke,[a("div",Ce,[a("img",{src:e.value.image_url,class:"border border-slate-300 dark:border-zinc-700 rounded-xl ml-auto mr-auto"},null,8,$e)]),a("h1",Te,C(e.value.title),1),a("div",we,C(e.value.description),1),a("div",Ve,[k.value?(s(),_(A,{key:0,to:"/users/"+k.value.id,class:"text-sm underline"},{default:T(()=>[N(C(k.value.first_name)+" "+C(k.value.last_name),1)]),_:1},8,["to"])):q("",!0)]),D.value?(s(),_(se,{key:0,onClick:t[0]||(t[0]=p=>j(!0))},{default:T(()=>[i(R(pe),{class:"m-1"})]),_:1})):q("",!0),a("div",Ue,[i(le,{"progress-value":e.value.progress,class:"m-2 w-1/3"},null,8,["progress-value"]),a("a",{class:"ml-auto underline",href:e.value.gdoc_url}," Ajouter un commentaire ",8,Oe)])])),a("div",null,[i(_e,{choices:h.value,default:n.value},null,8,["choices","default"])]),Be,l.value=="ctnt"?(s(),m("div",je,[e.value.publishing_state!="drft"?(s(),_(de,{key:0,"ext-comments":L.value,"ressource-id":e.value.id,"full-text":e.value.content,editable:D.value,onChange:t[4]||(t[4]=p=>F(p))},null,8,["ext-comments","ressource-id","full-text","editable"])):(s(),_(G,{key:1,class:"h-96",label:"Contenu",modelValue:e.value.content,"onUpdate:modelValue":t[5]||(t[5]=p=>F(p))},null,8,["modelValue"]))])):(s(),m("div",Fe,[i(ne,{open:c.value,onClose:t[7]||(t[7]=p=>c.value=!1)},{default:T(()=>[i(he,{onRefresh:x,onClose:t[6]||(t[6]=p=>c.value=!1),"thought-output":e.value},null,8,["thought-output"])]),_:1},8,["open"]),a("div",{onClick:t[8]||(t[8]=p=>c.value=!0),class:"text-sm italic underline"}," Ajouter une référence "),i(J,{"thought-inputs":b.value},null,8,["thought-inputs"])]))])):q("",!0)}}});export{Se as default};
