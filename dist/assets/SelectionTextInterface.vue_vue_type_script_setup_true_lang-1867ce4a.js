import{o as u,f as d,a as x,d as U,b as g,i as $,E,p as R,A as V,h as N,e as F,B as k,D as M,F as P,g as j,t as S}from"./index-99f79456.js";import{u as z}from"./SelectionTextInterface.vue_vue_type_style_index_0_lang-02959b5a.js";function K(e,t){return u(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})])}const J=U({__name:"ClipboardButton",props:{text:{}},setup(e){const t=e,c=g(!1),{launchSnackbar:i}=V(),r=async()=>{try{await navigator.clipboard.writeText(t.text),c.value=!0,i("Text copied to clipboard","success"),setTimeout(()=>c.value=!1,2e3)}catch(p){console.log(`Error with copy : ${p}`)}};return(p,f)=>(u(),d("div",null,[$(R(K),{onClick:r,class:E({"text-slate-400":c.value})},null,8,["class"])]))}});let v;const W=new Uint8Array(16);function q(){if(!v&&(v=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!v))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return v(W)}const n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function G(e,t=0){return n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]}const Q=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),T={randomUUID:Q};function X(e,t,c){if(T.randomUUID&&!t&&!e)return T.randomUUID();e=e||{};const i=e.random||(e.rng||q)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){c=c||0;for(let r=0;r<16;++r)t[c+r]=i[r];return t}return G(i)}const Y={class:""},Z=x("div",{class:"cursor bg-blue-400"},null,-1),ee=[Z],te=["onClick","id"],ne={key:0},oe={key:1,class:"ml-4"},ie=U({__name:"SelectionTextInterface",props:{text:{},editable:{type:Boolean}},emits:["change"],setup(e,{emit:t}){const c=e,{launchSnackbar:i}=V(),{formatText:r,textLines:p,keydown:f,editCount:B,parseTextLines:I}=z(),h=g(""),O=N(()=>r()),D=o=>{console.log(o);const a=window.getSelection();console.log("selection : ",a);const s=a.getRangeAt(0);console.log("range : ",s)},L=o=>{if(!c.editable)return;const s=window.getSelection().getRangeAt(0);l.value={line:o,startOffset:s.startOffset,endOffset:s.endOffset}},b=()=>{if(l.value.line===void 0)return;console.log(`CursorPosition : ${JSON.stringify(l.value)}`);const o=document.createRange(),a=document.getElementById(`line-${h.value}-${l.value.line}`);console.log("Selected LIne : ",a);const s=window.getComputedStyle(a).lineHeight,m=a.firstChild.firstChild;o.setStart(m,0),o.setEnd(m,l.value.startOffset);const w=o.getClientRects(),_=w[w.length-1];C.value={left:`${_.right}px`,bottom:`${_.bottom}px`,top:`${_.top-3}px`,height:s}},A=o=>{f(o,l)},C=g({left:"0px",right:"0px"}),l=g({line:void 0,startOffset:void 0,endOffset:void 0});F(()=>{h.value=X(),p.value=I(c.text),document.getElementById("router-view").addEventListener("scroll",()=>{b()})});const y=g(null),H=()=>{y.value!==null&&clearTimeout(y.value),y.value=setTimeout(async()=>{const o=r();o===""||!o?i("Try to update with empty content","error"):t("change",r())},1e3)};return k(B,()=>{H()}),k(l,()=>{b()},{deep:!0}),(o,a)=>(u(),d("div",Y,[x("div",{style:M(C.value),class:"absolute flex flex-column"},ee,4),$(J,{class:"ml-auto h-6 w-6",text:O.value},null,8,["text"]),x("div",{id:"editor-interface",tabindex:"0",onKeydown:a[0]||(a[0]=s=>A(s))},[(u(!0),d(P,null,j(R(p),(s,m)=>(u(),d("div",{class:E(["whitespace-pre-wrap",{"font-bold":s.bold}]),onClick:w=>L(m),onMouseup:D,id:`line-${h.value}-${m}`},[s.chip?(u(),d("li",oe,S(s.text),1)):(u(),d("div",ne,S(s.text===""?" ":s.text),1))],42,te))),256))],32)]))}});export{ie as _,J as a};
