import{o,c as d,f as r,d as T,r as g,l as N,m as P,n as w,F as E,p as R,i as _,_ as C,h as m,q as S,s as A,v as B,x as j,t as F,w as L,u as H,y as G,a as M,z as J,A as W,e as K}from"./index-da616e41.js";import{_ as Q,u as X}from"./TextInterface.vue_vue_type_script_setup_true_lang-96b53946.js";import{a as Y,_ as Z,b as ee}from"./ArticleForm.vue_vue_type_script_setup_true_lang-836de655.js";import{_ as k}from"./TextInput.vue_vue_type_script_setup_true_lang-49bf763d.js";import{_ as te}from"./ThoughtInputsList.vue_vue_type_script_setup_true_lang-6c3017ca.js";import{u as se}from"./useThoughtOutput-e73015fb.js";function oe(p,i){return o(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})])}const le={class:"mx-auto flex flex-wrap max-w-full"},ue=T({__name:"ToggleButtonGroup",props:{choices:{},default:{}},setup(p){const i=p,v=g(null),h=N(),a=P(),l=t=>{v.value=t;const f=a.query,c=a.path;h.push({path:c,query:{...f,tab:t}}),console.log(`route : ${JSON.stringify(a)}`)};return w(()=>l(i.default)),(t,f)=>(o(),d("div",le,[(o(!0),d(E,null,R(t.choices,c=>(o(),_(C,{key:c.value,class:"w-24 mx-auto my-1 md:mx-1",text:c.text,onClick:b=>l(c.value),type:c.value==v.value?"valid":"abort"},null,8,["text","onClick","type"]))),128))]))}}),ae={class:"flex"},ne={class:"flex"},re=T({__name:"ProblemForm",props:{problem:{}},emits:["change"],setup(p,{emit:i}){const v=p,h=(a,l)=>{let t={...v.problem};t[a]=l,i("change",t)};return(a,l)=>(o(),d("div",null,[m(k,{label:"Titre",modelValue:a.problem.title,"onUpdate:modelValue":l[0]||(l[0]=t=>h("title",t))},null,8,["modelValue"]),m(k,{class:"h-6",label:"Description",modelValue:a.problem.description,"onUpdate:modelValue":l[1]||(l[1]=t=>h("description",t))},null,8,["modelValue"]),r("div",ae,[m(Y,{class:"mr-auto h-6",label:"Progression",modelValue:a.problem.progress,"onUpdate:modelValue":l[2]||(l[2]=t=>h("progress",t))},null,8,["modelValue"])]),r("div",ne,[m(k,{class:"h-6",label:"Lien image",modelValue:a.problem.image_url,"onUpdate:modelValue":l[3]||(l[3]=t=>h("image_url",t))},null,8,["modelValue"])])]))}}),ie=async p=>(await S.get("/thought_outputs/"+p+"/thought_input_usages")).data;function de(){return{getThoughtInputUsagesForThoughtOutput:ie}}const ce={key:0,class:"px-8 mx-auto"},me={key:0},pe={class:"my-8"},ve=["src"],he={class:"text-3xl my-3 font-mplus md:text-center text-left"},ge={class:"md:text-center text-left"},_e={class:"md:flex my-8"},fe=["href"],be={key:1},ye={class:"flex flex-row-reverse"},xe={key:1,class:"p-2 border rounded bg-neutral-100"},ke=r("hr",{class:"border-top border-zinc-400 my-4"},null,-1),we={key:2},Ce={key:3},Ae=T({__name:"SeeArticle",props:{id:{}},setup(p){const i=p,v=P(),h=g([{text:"Contenu",value:"ctnt"},{text:"Biblio",value:"bbli"}]),a=g(null);A(()=>v.query.tab,s=>{console.log("new route query",s),a.value=s});const{getThoughtInputUsagesForThoughtOutput:l}=de(),t=g([]);w(async()=>t.value=await l(B(i).id.value));const{getThoughtOutput:f,updateThoughtOutput:c}=se(),b=g(null),e=g(null),z=N();A(()=>v.query.editing,s=>{console.log("Editing : ",s),y.value=s==="false"?!1:!!s});const y=g(!1),V=s=>{z.push({query:{editing:s}})},D=()=>{e.value.publishing_state="pbsh",c(e.value.id,e.value)},x=(s,u)=>{e.value=u,clearTimeout(b.value),b.value=setTimeout(async()=>{try{await c(s,e.value)}catch(n){console.log("An error : ",n)}},1e3)},$=s=>{s!=`
`&&x(B(i).id.value,{...e.value,content:s})},{user:U}=K(),O=j(()=>U.value?e.value.author_id==U.value.id:!1),{getCommentsForThoughtOutput:I}=X(),q=g([]);return w(async()=>{e.value=await f(i.id),q.value=await I(i.id);const s=v.query.editing;y.value=s==="false"?!1:!!s}),(s,u)=>e.value?(o(),d("div",ce,[y.value?(o(),d("div",be,[e.value.output_type=="atcl"?(o(),_(Z,{key:0,article:e.value,onChange:u[1]||(u[1]=n=>x(e.value.id,n))},null,8,["article"])):(o(),_(re,{key:1,problem:e.value,onChange:u[2]||(u[2]=n=>x(e.value.id,n))},null,8,["problem"])),r("div",ye,[m(C,{class:"mx-4",onClick:u[3]||(u[3]=n=>V(!1)),type:"valid",text:"Preview"},{default:L(()=>[W("Ok")]),_:1}),e.value.publishing_state=="drft"?(o(),_(C,{key:0,onClick:D,type:"valid",text:"Publier"})):(o(),d("div",xe,"PubliÃ©"))])])):(o(),d("div",me,[r("div",pe,[r("img",{src:e.value.image_url,class:"border border-slate-300 dark:border-zinc-700 rounded-xl ml-auto mr-auto"},null,8,ve)]),r("h1",he,F(e.value.title),1),r("div",ge,F(e.value.description),1),O.value?(o(),_(G,{key:0,onClick:u[0]||(u[0]=n=>V(!0))},{default:L(()=>[m(H(oe),{class:"m-1"})]),_:1})):M("",!0),r("div",_e,[m(J,{"progress-value":e.value.progress,class:"w-1/3"},null,8,["progress-value"]),r("a",{class:"ml-auto underline",href:e.value.gdoc_url}," Ajouter un commentaire ",8,fe)])])),r("div",null,[m(ue,{choices:h.value,default:"ctnt"},null,8,["choices"])]),ke,a.value=="ctnt"?(o(),d("div",we,[e.value.publishing_state!="drft"?(o(),_(Q,{key:0,"ext-comments":q.value,"ressource-id":e.value.id,"full-text":e.value.content,editable:O.value,onChange:u[4]||(u[4]=n=>$(n))},null,8,["ext-comments","ressource-id","full-text","editable"])):(o(),_(ee,{key:1,class:"h-96",label:"Contenu",modelValue:e.value.content,"onUpdate:modelValue":u[5]||(u[5]=n=>$(n))},null,8,["modelValue"]))])):(o(),d("div",Ce,[m(te,{"thought-inputs":t.value.map(n=>n.thought_input)},null,8,["thought-inputs"])]))])):M("",!0)}});export{Ae as default};
