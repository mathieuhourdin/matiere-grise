import{a as F,_ as P}from"./useArticle-e99867f6.js";import{_ as f}from"./TextInput.vue_vue_type_script_setup_true_lang-9d731f2d.js";import{d as j,r as O,b as R,c as A,e as D,u as H}from"./ResourceComponent.vue_vue_type_script_setup_true_lang-74605ae1.js";import{_ as L}from"./ActionButton.vue_vue_type_script_setup_true_lang-71ad9329.js";import{d as k,u as h,q as w,r as p,o as I,w as B,c as i,e as n,t as g,g as C,h as N,j as c,f as l,m as q,b as a,k as x,F as M,l as S}from"./index-8602af68.js";import{_ as z}from"./ArticleCard.vue_vue_type_script_setup_true_lang-2574575e.js";import{_ as G}from"./CreateThoughtInput.vue_vue_type_script_setup_true_lang-190984e8.js";import"./TextInterface.vue_vue_type_script_setup_true_lang-a5d3abbd.js";import"./ProgressBar.vue_vue_type_script_setup_true_lang-3372b699.js";import"./useResource-a3f0b3e1.js";import"./useProblem-c7671e8b.js";const J={class:"text-center p-4 bg-slate-200"},K={key:0},Q=["src"],W={class:"text-2xl bold"},X={class:"mt-4"},Y={key:1},Z={class:"flex mx-auto"},ee={key:0,class:"flex"},se={class:"flex flex-row-reverse"},te=k({__name:"UserInfos",props:{user:{}},setup(U){const m=U,{user:_,debouncedUpdateUser:V}=q(),b=h(),v=w(()=>!m.user.is_platform_user||m.user.id===_.value.id),d=p(!1),s=p(null);return I(()=>{s.value=m.user,d.value=b.query.editingUser}),B(s,o=>V(o.id,o),{deep:!0}),(o,e)=>(a(),i("div",J,[d.value?(a(),i("div",Y,[l(f,{class:"mx-auto w-2/3",modelValue:s.value.profile_picture_url,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.profile_picture_url=t),label:"Photo de profil"},null,8,["modelValue"]),n("div",Z,[l(f,{class:"ml-auto",modelValue:s.value.first_name,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.first_name=t),label:"PrÃ©nom"},null,8,["modelValue"]),l(f,{class:"mr-auto",modelValue:s.value.last_name,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.last_name=t),label:"Nom"},null,8,["modelValue"])]),s.value.is_platform_user?(a(),i("div",ee,[l(f,{class:"ml-auto",modelValue:s.value.handle,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.handle=t),label:"Handle"},null,8,["modelValue"]),l(f,{class:"mr-auto",modelValue:s.value.email,"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.email=t),label:"Email"},null,8,["modelValue"])])):c("",!0),n("div",null,[l(j,{modelValue:s.value.biography,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.biography=t),label:"Bio"},null,8,["modelValue"])]),n("div",se,[l(L,{onClick:e[7]||(e[7]=t=>d.value=!1),text:"Valider",type:"valid"})])])):(a(),i("div",K,[n("img",{src:o.user.profile_picture_url,class:"mx-auto m-4 w-1/6"},null,8,Q),n("div",W,g(o.user.first_name)+" "+g(o.user.last_name),1),n("div",null,g(o.user.handle),1),n("div",null,g(o.user.email),1),n("div",X,g(o.user.biography),1),v.value?(a(),C(F,{key:0,class:"right-4 absolute",onClick:e[0]||(e[0]=t=>d.value=!0)},{default:N(()=>[l(x(O),{class:"m-1"})]),_:1})):c("",!0)]))]))}}),le={class:"m-8"},ae={key:1},oe={key:2},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},be=k({__name:"UserFeedView",props:{pageUserId:{}},setup(U){const m=U,_=p(!1),{getUserById:V,user:b}=q(),v=p(null),d=p("bibl"),s=h();B(()=>s.query.interaction_type,u=>{console.log("new route query",u),typeof u=="string"&&(d.value=u)});const{getUserThoughtOutputs:o}=D(),e=p([]),{getUserThoughtInputs:t}=H(),$=p([]),T=w(()=>$.value.map(u=>({resource:u.resource,date:u.interaction_date,user_id:u.interaction_user_id,context_comment:u.interaction_comment,progress:u.interaction_progress})));return I(async()=>{v.value=await V(m.pageUserId),$.value=await t(m.pageUserId),e.value=await o(m.pageUserId)}),(u,y)=>(a(),i("div",null,[n("div",le,[v.value?(a(),C(te,{key:0,class:"mx-auto border my-8",user:v.value},null,8,["user"])):c("",!0),l(P,{"url-key":"interaction_type",choices:[{text:"Biblio",value:"bibl"},{text:"Productions",value:"prdc"}],default:"bibl",class:"my-6",url:""}),d.value==="bibl"?(a(),i("div",ae,[x(b)&&u.pageUserId==x(b).id?(a(),i("div",{key:0,class:"italic underline text-xs",onClick:y[0]||(y[0]=r=>_.value=!0)}," Ajouter un nouvel apport ")):c("",!0),l(R,{open:_.value},{default:N(()=>[l(G,{onClose:y[1]||(y[1]=r=>_.value=!1)})]),_:1},8,["open"]),l(A,{class:"mx-auto","contextual-resources":T.value},null,8,["contextual-resources"])])):c("",!0),d.value==="prdc"?(a(),i("div",oe,[n("div",ue,[(a(!0),i(M,null,S(e.value.map(r=>r.resource),(r,E)=>(a(),i("div",{key:E},[l(z,{title:r.title,subtitle:r.subtitle,"image-url":r.image_url,progress:r.interaction_progress,uuid:r.id,author:r.author},null,8,["title","subtitle","image-url","progress","uuid","author"])]))),128))])])):c("",!0)])]))}});export{be as default};
