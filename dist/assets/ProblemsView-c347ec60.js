import{A as x,d as b,r as h,j as g,s as k,o as n,c as m,h as f,w as T,f as r,t as d,a as v,e as $,k as A,F as y,m as w,n as B,p as F,i as I}from"./index-6c02f670.js";import{a as U,u as D}from"./useThoughtOutput-ec10b25f.js";const{createThoughtOutput:L}=U(),N=()=>({resource_title:"",resource_subtitle:"",resource_content:"",publishing_state:"drft",resource_image_url:"",resource_type:"pblm",progress:0,resource_comment:"",maturing_state:""}),V=o=>(o.created_at&&(o.created_at=new Date(o.created_at.split(".")[0])),o),O=async()=>(await x.get("/problems")).data.map(a=>V(a));function P(){return{newProblem:N,getProblems:O,createProblem:L}}const R={class:"border shadow-xl rounded m-2 p-4 h-72 w-60"},j={class:"max-h-full"},S=["src"],W={class:"h-full"},q={class:"mb-2"},E={key:0,class:"text-2xs italic",style:{"margin-top":"-8px"}},M={class:"text-2xs mb-auto"},z={class:"flex mt-2"},G={class:"text-2xs italic mt-auto"},H={class:"ml-auto text-2xs underline"},J=b({__name:"ProblemCard",props:{problem:{}},setup(o){const a=o,u=t=>t?t.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",c=h(null),p=t=>t.length>200?t.slice(0,150)+"...":t,_=h([]),{getThoughtInputUsagesForThoughtOutput:i}=D(),e=async()=>{a.problem.id&&(_.value=await i(a.problem.id))},{getUserById:s}=$(),l=async()=>{a.problem.author_id&&(c.value=await s(a.problem.author_id))};return g(async()=>{await e(),await l()}),(t,ee)=>{const C=k("router-link");return n(),m("div",R,[f(C,{to:"/thought_outputs/"+t.problem.id},{default:T(()=>[r("div",j,[r("img",{class:"h-28 mx-auto mb-4",src:t.problem.resource_image_url},null,8,S),r("div",W,[r("div",q,d(t.problem.resource_title),1),c.value?(n(),m("div",E,d(c.value.first_name)+" "+d(c.value.last_name),1)):v("",!0),r("div",M,d(p(t.problem.resource_subtitle)),1),r("div",z,[r("div",G,d(u(t.problem.created_at)),1),r("div",H,d(_.value.length)+" inputs",1)])])])]),_:1},8,["to"])])}}}),K={class:"flex"},Q=r("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),X={class:"flex overflow-scroll"},Y=b({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(o){const a=o,{newProblem:u,createProblem:c}=P(),p=A(),_=async()=>{const e=u();e.resource_category_id=a.category.id;const s=await c(e);p.push({path:"/thought_outputs/"+s.id,query:{editing:"true"}})},i=e=>e=="default"?"Autres":e;return(e,s)=>(n(),m("div",null,[r("div",K,[r("div",null,d(i(e.category.display_name)),1),r("div",{onClick:_,class:"ml-auto text-sm mr-2 underline"},"Ajouter")]),Q,r("div",X,[(n(!0),m(y,null,w(e.problemsList,(l,t)=>(n(),m("div",{class:"mb-4",key:t},[f(J,{problem:l},null,8,["problem"])]))),128))])]))}}),Z={key:0,class:"m-4"},re=b({__name:"ProblemsView",setup(o){const{getProblems:a}=P(),u=h(null),{categories:c}=F(),p=B(()=>c.value.map(e=>(e.problems=_(e),e.problems_count=e.problems?e.problems.length:0,e))),_=i=>{var e,s;return i.display_name=="default"?(e=u.value)==null?void 0:e.filter(l=>l.resource_category_id==null):(s=u.value)==null?void 0:s.filter(l=>l.resource_category_id==i.id)};return g(async()=>u.value=await a()),(i,e)=>(n(),m("div",null,[u.value?(n(),m("div",Z,[(n(!0),m(y,null,w(p.value.sort((s,l)=>l.problems_count-s.problems_count),s=>(n(),I(Y,{class:"mt-4",category:s,key:s.id,"problems-list":s.problems},null,8,["category","problems-list"]))),128))])):v("",!0)]))}});export{re as default};
