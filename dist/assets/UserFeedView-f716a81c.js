import{a as F,_ as P}from"./useArticle-9d358cd8.js";import{_ as f}from"./TextInput.vue_vue_type_script_setup_true_lang-55595cfd.js";import{d as j,r as O,b as R,c as A,u as D}from"./ResourceComponent.vue_vue_type_script_setup_true_lang-a1518895.js";import{_ as H}from"./ActionButton.vue_vue_type_script_setup_true_lang-b9879b74.js";import{d as k,j as h,c as w,r as p,o as I,k as B,e as i,f as n,t as g,i as C,w as N,n as c,g as l,u as T,b as a,p as x,F as L,h as M}from"./index-beadb412.js";import{_ as S}from"./ArticleCard.vue_vue_type_script_setup_true_lang-b0cbf9be.js";import{_ as z}from"./CreateThoughtInput.vue_vue_type_script_setup_true_lang-09b5a595.js";import{u as G}from"./useInteraction-78c629a0.js";import"./TextInterface.vue_vue_type_script_setup_true_lang-8761163d.js";import"./ProgressBar.vue_vue_type_script_setup_true_lang-d535db5f.js";import"./useResource-5ac629f4.js";import"./useResourceRelations-cc695e3a.js";import"./useProblem-4412fdf5.js";const J={class:"text-center p-4 bg-slate-200"},K={key:0},Q=["src"],W={class:"text-2xl bold"},X={class:"mt-4"},Y={key:1},Z={class:"flex mx-auto"},ee={key:0,class:"flex"},se={class:"flex flex-row-reverse"},te=k({__name:"UserInfos",props:{user:{}},setup(U){const m=U,{user:_,debouncedUpdateUser:V}=T(),b=h(),v=w(()=>!m.user.is_platform_user||m.user.id===_.value.id),d=p(!1),s=p(null);return I(()=>{s.value=m.user,d.value=b.query.editingUser}),B(s,o=>V(o.id,o),{deep:!0}),(o,e)=>(a(),i("div",J,[d.value?(a(),i("div",Y,[l(f,{class:"mx-auto w-2/3",modelValue:s.value.profile_picture_url,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.profile_picture_url=t),label:"Photo de profil"},null,8,["modelValue"]),n("div",Z,[l(f,{class:"ml-auto",modelValue:s.value.first_name,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.first_name=t),label:"PrÃ©nom"},null,8,["modelValue"]),l(f,{class:"mr-auto",modelValue:s.value.last_name,"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.last_name=t),label:"Nom"},null,8,["modelValue"])]),s.value.is_platform_user?(a(),i("div",ee,[l(f,{class:"ml-auto",modelValue:s.value.handle,"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.handle=t),label:"Handle"},null,8,["modelValue"]),l(f,{class:"mr-auto",modelValue:s.value.email,"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.email=t),label:"Email"},null,8,["modelValue"])])):c("",!0),n("div",null,[l(j,{modelValue:s.value.biography,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.biography=t),label:"Bio"},null,8,["modelValue"])]),n("div",se,[l(H,{onClick:e[7]||(e[7]=t=>d.value=!1),text:"Valider",type:"valid"})])])):(a(),i("div",K,[n("img",{src:o.user.profile_picture_url,class:"mx-auto m-4 w-1/6"},null,8,Q),n("div",W,g(o.user.first_name)+" "+g(o.user.last_name),1),n("div",null,g(o.user.handle),1),n("div",null,g(o.user.email),1),n("div",X,g(o.user.biography),1),v.value?(a(),C(F,{key:0,class:"right-4 absolute",onClick:e[0]||(e[0]=t=>d.value=!0)},{default:N(()=>[l(x(O),{class:"m-1"})]),_:1})):c("",!0)]))]))}}),le={class:"m-8"},ae={key:1},oe={key:2},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ue=k({__name:"UserFeedView",props:{pageUserId:{}},setup(U){const m=U,_=p(!1),{getUserById:V,user:b}=T(),v=p(null),d=p("bibl"),s=h();B(()=>s.query.interaction_type,r=>{console.log("new route query",r),typeof r=="string"&&(d.value=r)});const{getUserThoughtOutputs:o}=G(),e=p([]),{getUserThoughtInputs:t}=D(),$=p([]),q=w(()=>$.value.map(r=>({resource:r.resource,date:r.interaction_date,user_id:r.interaction_user_id,context_comment:r.interaction_comment,progress:r.interaction_progress})));return I(async()=>{v.value=await V(m.pageUserId),$.value=await t(m.pageUserId),e.value=await o(m.pageUserId)}),(r,y)=>(a(),i("div",null,[n("div",le,[v.value?(a(),C(te,{key:0,class:"mx-auto border my-8",user:v.value},null,8,["user"])):c("",!0),l(P,{"url-key":"interaction_type",choices:[{text:"Biblio",value:"bibl"},{text:"Productions",value:"prdc"}],default:"bibl",class:"my-6",url:""}),d.value==="bibl"?(a(),i("div",ae,[x(b)&&r.pageUserId==x(b).id?(a(),i("div",{key:0,class:"italic underline text-xs",onClick:y[0]||(y[0]=u=>_.value=!0)}," Ajouter un nouvel apport ")):c("",!0),l(R,{open:_.value},{default:N(()=>[l(z,{onClose:y[1]||(y[1]=u=>_.value=!1)})]),_:1},8,["open"]),l(A,{class:"mx-auto","contextual-resources":q.value},null,8,["contextual-resources"])])):c("",!0),d.value==="prdc"?(a(),i("div",oe,[n("div",re,[(a(!0),i(L,null,M(e.value.map(u=>u.resource),(u,E)=>(a(),i("div",{key:E},[l(S,{title:u.title,subtitle:u.subtitle,"image-url":u.image_url,progress:u.interaction_progress,uuid:u.id,author:u.author},null,8,["title","subtitle","image-url","progress","uuid","author"])]))),128))])])):c("",!0)])]))}});export{Ue as default};
