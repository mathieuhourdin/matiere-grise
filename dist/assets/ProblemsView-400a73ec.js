import{A as x,d as b,r as h,j as g,s as k,o as l,c as m,h as f,w as T,f as o,t as d,a as v,e as $,k as A,F as y,m as w,n as B,p as F,i as I}from"./index-4b7f2cf0.js";import{a as U,u as D}from"./useThoughtOutput-032608f0.js";const{createThoughtOutput:L}=U(),N=()=>({title:"",description:"",content:"",publishing_state:"drft",image_url:"",output_type:"pblm",progress:0,potential_improvements:"",maturing_state:""}),V=r=>(r.created_at&&(r.created_at=new Date(r.created_at.split(".")[0])),r),O=async()=>(await x.get("/problems")).data.map(a=>V(a));function P(){return{newProblem:N,getProblems:O,createProblem:L}}const R={class:"border shadow-xl rounded m-2 p-4 h-72 w-60"},j={class:"max-h-full"},S=["src"],W={class:"h-full"},q={class:"mb-2"},E={key:0,class:"text-2xs italic",style:{"margin-top":"-8px"}},M={class:"text-2xs mb-auto"},z={class:"flex mt-2"},G={class:"text-2xs italic mt-auto"},H={class:"ml-auto text-2xs underline"},J=b({__name:"ProblemCard",props:{problem:{}},setup(r){const a=r,u=t=>t?t.toLocaleString("fr-FR",{hour:"numeric",weekday:"short",day:"numeric",month:"short",year:"2-digit"}):"",i=h(null),_=t=>t.length>200?t.slice(0,150)+"...":t,p=h([]),{getThoughtInputUsagesForThoughtOutput:c}=D(),e=async()=>{a.problem.id&&(p.value=await c(a.problem.id))},{getUserById:s}=$(),n=async()=>{a.problem.author_id&&(i.value=await s(a.problem.author_id))};return g(async()=>{await e(),await n()}),(t,ee)=>{const C=k("router-link");return l(),m("div",R,[f(C,{to:"/thought_outputs/"+t.problem.id},{default:T(()=>[o("div",j,[o("img",{class:"h-28 mx-auto mb-4",src:t.problem.image_url},null,8,S),o("div",W,[o("div",q,d(t.problem.title),1),i.value?(l(),m("div",E,d(i.value.first_name)+" "+d(i.value.last_name),1)):v("",!0),o("div",M,d(_(t.problem.description)),1),o("div",z,[o("div",G,d(u(t.problem.created_at)),1),o("div",H,d(p.value.length)+" inputs",1)])])])]),_:1},8,["to"])])}}}),K={class:"flex"},Q=o("hr",{class:"border-top border-slate-800 border-dashed my-1"},null,-1),X={class:"flex overflow-scroll"},Y=b({__name:"CategoryProblemsCarousel",props:{problemsList:{},category:{}},setup(r){const a=r,{newProblem:u,createProblem:i}=P(),_=A(),p=async()=>{const e=u();e.category_id=a.category.id;const s=await i(e);_.push({path:"/thought_outputs/"+s.id,query:{editing:"true"}})},c=e=>e=="default"?"Autres":e;return(e,s)=>(l(),m("div",null,[o("div",K,[o("div",null,d(c(e.category.display_name)),1),o("div",{onClick:p,class:"ml-auto text-sm mr-2 underline"},"Ajouter")]),Q,o("div",X,[(l(!0),m(y,null,w(e.problemsList,(n,t)=>(l(),m("div",{class:"mb-4",key:t},[f(J,{problem:n},null,8,["problem"])]))),128))])]))}}),Z={key:0,class:"m-4"},oe=b({__name:"ProblemsView",setup(r){const{getProblems:a}=P(),u=h(null),{categories:i}=F(),_=B(()=>i.value.map(e=>(e.problems=p(e),e.problems_count=e.problems?e.problems.length:0,e))),p=c=>{var e,s;return c.display_name=="default"?(e=u.value)==null?void 0:e.filter(n=>n.category_id==null):(s=u.value)==null?void 0:s.filter(n=>n.category_id==c.id)};return g(async()=>u.value=await a()),(c,e)=>(l(),m("div",null,[u.value?(l(),m("div",Z,[(l(!0),m(y,null,w(_.value.sort((s,n)=>n.problems_count-s.problems_count),s=>(l(),I(Y,{class:"mt-4",category:s,key:s.id,"problems-list":s.problems},null,8,["category","problems-list"]))),128))])):v("",!0)]))}});export{oe as default};
